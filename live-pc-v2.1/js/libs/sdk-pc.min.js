"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,r,o,a,s=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?c+"":"null";case"boolean":case"null":return c+"";case"object":if(!c)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(c)){for(o=c.length,n=0;o>n;n+=1)a[n]=str(n,c)||"null";return r=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,r}if(rep&&"object"==typeof rep)for(o=rep.length,n=0;o>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],r=str(i,c),r&&a.push(quote(i)+(gap?": ":":")+r));else for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(r=str(i,c),r&&a.push(quote(i)+(gap?": ":":")+r));return r=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,r}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var n,i,r=e[t];if(r&&"object"==typeof r)for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i=walk(r,n),void 0!==i?r[n]=i:delete r[n]);return reviver.call(e,t,r)}var j;if(text+="",cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.io=e()}}(function(){var e;return function t(e,n,i){function r(a,s){if(!n[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};e[a][0].call(u.exports,function(t){var n=e[a][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,n){function i(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=r(e),o=i.source,u=i.id;return t.forceNew||t["force new connection"]||!1===t.multiplex?(s("ignoring socket cache for %s",o),n=a(o,t)):(c[u]||(s("new io instance for %s",o),c[u]=a(o,t)),n=c[u]),n.socket(i.path)}var r=e("./url"),o=e("socket.io-parser"),a=e("./manager"),s=e("debug")("socket.io-client");t.exports=n=i;var c=n.managers={};n.protocol=o.protocol,n.connect=i,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(e,t){function n(e,t){return this instanceof n?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new n(e,t)}var i=(e("./url"),e("engine.io-client")),r=e("./socket"),o=e("component-emitter"),a=e("socket.io-parser"),s=e("./on"),c=e("component-bind"),u=(e("object-component"),e("debug")("socket.io-client:manager")),l=e("indexof"),f=e("backo2");t.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},n.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},o(n.prototype),n.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},n.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},n.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(e){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=i(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=s(t,"open",function(){n.onopen(),e&&e()}),o=s(t,"error",function(t){if(u("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var i=new Error("Connection error");i.data=t,e(i)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;u("connect attempt will timeout after %d",a);var c=setTimeout(function(){u("connect attempt timed out after %d",a),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(r),this.subs.push(o),this},n.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(s(e,"data",c(this,"ondata"))),this.subs.push(s(this.decoder,"decoded",c(this,"ondecoded"))),this.subs.push(s(e,"error",c(this,"onerror"))),this.subs.push(s(e,"close",c(this,"onclose")))},n.prototype.ondata=function(e){this.decoder.add(e)},n.prototype.ondecoded=function(e){this.emit("packet",e)},n.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},n.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new r(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~l(n.connected,t)||n.connected.push(t)})}return t},n.prototype.destroy=function(e){var t=l(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},n.prototype.packet=function(e){u("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var n=0;n<e.length;n++)t.engine.write(e[n]);t.encoding=!1,t.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},n.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(e){u("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();u("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(u("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(u("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(u("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},n.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(e,t){function n(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}t.exports=n},{}],5:[function(e,t,n){function i(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var r=e("socket.io-parser"),o=e("component-emitter"),a=e("to-array"),s=e("./on"),c=e("component-bind"),u=e("debug")("socket.io-client:socket"),l=e("has-binary");t.exports=n=i;var f={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},h=o.prototype.emit;o(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",c(this,"onopen")),s(e,"packet",c(this,"onpacket")),s(e,"close",c(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},i.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},i.prototype.emit=function(e){if(f.hasOwnProperty(e))return h.apply(this,arguments),this;var t=a(arguments),n=r.EVENT;l(t)&&(n=r.BINARY_EVENT);var i={type:n,data:t};return"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this},i.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},i.prototype.onopen=function(){u("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},i.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},i.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(e);break;case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:this.onack(e);break;case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},i.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},i.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=a(arguments);u("sending ack %j",i);var o=l(i)?r.BINARY_ACK:r.ACK;t.packet({type:o,id:e,data:i})}}},i.prototype.onack=function(e){u("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(e,t){(function(n){function i(e,t){var i=e,t=t||n.location;return null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e="undefined"!=typeof t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),i=r(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/",i.id=i.protocol+"://"+i.host+":"+i.port,i.href=i.protocol+"://"+i.host+(t&&t.port==i.port?"":":"+i.port),i}var r=e("parseuri"),o=e("debug")("socket.io-client:url");t.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:44}],7:[function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},{}],8:[function(e,t){var n=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var i=n.call(arguments,2);return function(){return t.apply(e,i.concat(n.call(arguments)))}}},{}],9:[function(e,t){function n(e){return e?i(e):void 0}function i(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){i.off(e,n),t.apply(this,arguments)}var i=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i,r=0;r<n.length;r++)if(i=n[r],i===t||i.fn===t){n.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var i=0,r=n.length;r>i;++i)n[i].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],10:[function(e,t){function n(e){return n.enabled(e)?function(t){t=i(t);var r=new Date,o=r-(n[e]||r);n[e]=r,t=e+" "+t+" +"+n.humanize(o),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function i(e){return e instanceof Error?e.stack||e.message:e}t.exports=n,n.names=[],n.skips=[],n.enable=function(e){try{localStorage.debug=e}catch(t){}for(var i=(e||"").split(/[\s,]+/),r=i.length,o=0;r>o;o++)e=i[o].replace("*",".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$"))},n.disable=function(){n.enable("")},n.humanize=function(e){var t=1e3,n=6e4,i=60*n;return e>=i?(e/i).toFixed(1)+"h":e>=n?(e/n).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},n.enabled=function(e){for(var t=0,i=n.skips.length;i>t;t++)if(n.skips[t].test(e))return!1;for(var t=0,i=n.names.length;i>t;t++)if(n.names[t].test(e))return!0;return!1};try{window.localStorage&&n.enable(localStorage.debug)}catch(r){}},{}],11:[function(e,t){t.exports=e("./lib/")},{"./lib/":12}],12:[function(e,t){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(e,t){(function(n){function i(e,t){if(!(this instanceof i))return new i(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=l(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:n.location&&"https:"==location.protocol,t.host){var r=t.host.split(":");t.hostname=r.shift(),r.length?t.port=r.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(n.location?location.hostname:"localhost"),this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=h.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate?t.perMessageDeflate||!0:!1,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}function r(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var o=e("./transports"),a=e("component-emitter"),s=e("debug")("engine.io-client:socket"),c=e("indexof"),u=e("engine.io-parser"),l=e("parseuri"),f=e("parsejson"),h=e("parseqs");t.exports=i,i.priorWebsocketSuccess=!1,a(i.prototype),i.protocol=u.protocol,i.Socket=i,i.Transport=e("./transport"),i.transports=e("./transports"),i.parser=e("engine.io-parser"),i.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=r(this.query);t.EIO=u.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new o[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate});return n},i.prototype.open=function(){var e;if(this.rememberUpgrade&&i.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";var e;try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},i.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},i.prototype.probe=function(e){function t(){if(h.onlyBinaryUpgrades){var t=!this.supportsBinary&&h.transport.supportsBinary;f=f||t}f||(s('probe transport "%s" opened',e),l.send([{type:"ping",data:"probe",options:{compress:!0}}]),l.once("packet",function(t){if(!f)if("pong"==t.type&&"probe"==t.data){if(s('probe transport "%s" pong',e),h.upgrading=!0,h.emit("upgrading",l),!l)return;i.priorWebsocketSuccess="websocket"==l.name,s('pausing current transport "%s"',h.transport.name),h.transport.pause(function(){f||"closed"!=h.readyState&&(s("changing transport and sending upgrade packet"),u(),h.setTransport(l),l.send([{type:"upgrade",options:{compress:!0}}]),h.emit("upgrade",l),l=null,h.upgrading=!1,h.flush())})}else{s('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=l.name,h.emit("upgradeError",n)}}))}function n(){f||(f=!0,u(),l.close(),l=null)}function r(t){var i=new Error("probe error: "+t);i.transport=l.name,n(),s('probe transport "%s" failed because of error: %s',e,t),h.emit("upgradeError",i)}function o(){r("transport closed")}function a(){r("socket closed")}function c(e){l&&e.name!=l.name&&(s('"%s" works - aborting "%s"',e.name,l.name),n())}function u(){l.removeListener("open",t),l.removeListener("error",r),l.removeListener("close",o),h.removeListener("close",a),h.removeListener("upgrading",c)}s('probing transport "%s"',e);var l=this.createTransport(e,{probe:1}),f=!1,h=this;i.priorWebsocketSuccess=!1,l.once("open",t),l.once("error",r),l.once("close",o),this.once("close",a),this.once("upgrading",c),l.open()},i.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",i.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},i.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(f(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},i.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},i.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},i.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},i.prototype.ping=function(){this.sendPacket("ping")},i.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},i.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},i.prototype.write=i.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},i.prototype.sendPacket=function(e,t,n,i){if("function"==typeof n&&(i=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){n=n||{},n.compress=!1!==n.compress;var r={type:e,data:t,options:n};this.emit("packetCreate",r),this.writeBuffer.push(r),this.callbackBuffer.push(i),this.flush()}},i.prototype.close=function(){function e(){i.onClose("forced close"),s("socket closing - telling transport to close"),i.transport.close()}function t(){i.removeListener("upgrade",t),i.removeListener("upgradeError",t),e()}function n(){i.once("upgrade",t),i.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var i=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},i.prototype.onError=function(e){s("socket error %j",e),i.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},i.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){s('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},i.prototype.filterUpgrades=function(e){for(var t=[],n=0,i=e.length;i>n;n++)~c(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(e,t){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}var i=e("engine.io-parser"),r=e("component-emitter");t.exports=n,r(n.prototype),n.timestamps=0,n.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},n.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(e,t,n){(function(t){function i(e){var n,i=!1,s=!1,c=!1!==e.jsonp;if(t.location){var u="https:"==location.protocol,l=location.port;l||(l=u?443:80),i=e.hostname!=location.hostname||l!=e.port,s=e.secure!=u}if(e.xdomain=i,e.xscheme=s,n=new r(e),"open"in n&&!e.forceJSONP)return new o(e);if(!c)throw new Error("JSONP disabled");return new a(e)}var r=e("xmlhttprequest"),o=e("./polling-xhr"),a=e("./polling-jsonp"),s=e("./websocket");n.polling=i,n.websocket=s}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(e,t){(function(n){function i(){}function r(e){o.call(this,e),this.query=this.query||{},s||(n.___eio||(n.___eio=[]),s=n.___eio),this.index=s.length;var t=this;s.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=i)},!1)}var o=e("./polling"),a=e("component-inherit");t.exports=r;var s,c=/\n/g,u=/\\n/g;a(r,o),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},r.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.script=t;var i="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);i&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},r.prototype.doWrite=function(e,t){function n(){i(),t()}function i(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';o=document.createElement(t)}catch(e){o=document.createElement("iframe"),o.name=r.iframeId,o.src="javascript:0"}o.id=r.iframeId,r.form.appendChild(o),r.iframe=o}var r=this;if(!this.form){var o,a=document.createElement("form"),s=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=l,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),i(),e=e.replace(u,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(f){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==r.iframe.readyState&&n()}:this.iframe.onload=n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(e,t){(function(n){function i(){}function r(e){if(c.call(this,e),n.location){var t="https:"==location.protocol,i=location.port;i||(i=t?443:80),this.xd=e.hostname!=n.location.hostname||i!=e.port,this.xs=e.secure!=t}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function a(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var s=e("xmlhttprequest"),c=e("./polling"),u=e("component-emitter"),l=e("component-inherit"),f=e("debug")("engine.io-client:polling-xhr");
t.exports=r,t.exports.Request=o,l(r,c),r.prototype.supportsBinary=!0,r.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new o(e)},r.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,i=this.request({method:"POST",data:e,isBinary:n}),r=this;i.on("success",t),i.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=i},r.prototype.doPoll=function(){f("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},u(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new s(e),i=this;try{if(f("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async),this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){i.onLoad()},t.onerror=function(){i.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?i.onLoad():setTimeout(function(){i.onError(t.status)},0))},f("xhr data %s",this.data),t.send(this.data)}catch(r){return void setTimeout(function(){i.onError(r)},0)}n.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=i:this.xhr.onreadystatechange=i,e)try{this.xhr.abort()}catch(t){}n.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}e="application/octet-stream"===t?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},o.prototype.hasXDR=function(){return"undefined"!=typeof n.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},n.document&&(o.requestsCount=0,o.requests={},n.attachEvent?n.attachEvent("onunload",a):n.addEventListener&&n.addEventListener("beforeunload",a,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(e,t){function n(e){var t=e&&e.forceBase64;(!c||t)&&(this.supportsBinary=!1),i.call(this,e)}var i=e("../transport"),r=e("parseqs"),o=e("engine.io-parser"),a=e("component-inherit"),s=e("debug")("engine.io-client:polling");t.exports=n;var c=function(){var t=e("xmlhttprequest"),n=new t({xdomain:!1});return null!=n.responseType}();a(n,i),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(e){function t(){s("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var i=0;this.polling&&(s("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){s("pre-pause polling complete"),--i||t()})),this.writable||(s("we are currently writing - waiting to pause"),i++,this.once("drain",function(){s("pre-pause writing complete"),--i||t()}))}else t()},n.prototype.poll=function(){s("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var t=this;s("polling got data %s",e);var n=function(e){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};o.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():s('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function e(){s("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(s("transport open - closing"),e()):(s("transport not open - deferring close"),this.once("open",e))},n.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+i.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(e,t){function n(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,i.call(this,e)}var i=e("../transport"),r=e("engine.io-parser"),o=e("parseqs"),a=e("component-inherit"),s=e("debug")("engine.io-client:websocket"),c=e("ws");t.exports=n,a(n,i),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.ws=new c(e,t,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(n.prototype.onData=function(e){var t=this;setTimeout(function(){i.prototype.onData.call(t,e)},0)}),n.prototype.write=function(e){function t(){n.writable=!0,n.emit("drain")}var n=this;this.writable=!1;for(var i=0,o=e.length;o>i;i++){var a=e[i];r.encodePacket(a,this.supportsBinary,function(e){try{n.ws.send(e,a.options)}catch(t){s("websocket closed before onclose event")}})}setTimeout(t,0)},n.prototype.onClose=function(){i.prototype.onClose.call(this)},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),e=o.encode(e),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},n.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===n.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(e,t){var n=e("has-cors");t.exports=function(e){var t=e.xdomain,i=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||n))return new XMLHttpRequest}catch(o){}try{if("undefined"!=typeof XDomainRequest&&!i&&r)return new XDomainRequest}catch(o){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}}},{"has-cors":40}],21:[function(e,t){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],22:[function(e,t,n){function i(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var i="color: "+this.color;e=[e[0],i,"color: inherit"].concat(Array.prototype.slice.call(e,1));var r=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%"!==e&&(r++,"%c"===e&&(o=r))}),e.splice(o,0,i),e}function o(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(t){}}function s(){var e;try{e=localStorage.debug}catch(t){}return e}n=t.exports=e("./debug"),n.log=o,n.formatArgs=r,n.save=a,n.load=s,n.useColors=i,n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(s())},{"./debug":23}],23:[function(e,t,n){function i(){return n.colors[l++%n.colors.length]}function r(e){function t(){}function r(){var e=r,t=+new Date,o=t-(u||t);e.diff=o,e.prev=u,e.curr=t,u=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=i());var a=Array.prototype.slice.call(arguments);a[0]=n.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(t,i){if("%"===t)return t;s++;var r=n.formatters[i];if("function"==typeof r){var o=a[s];t=r.call(e,o),a.splice(s,1),s--}return t}),"function"==typeof n.formatArgs&&(a=n.formatArgs.apply(e,a));var c=r.log||n.log||console.log.bind(console);c.apply(e,a)}t.enabled=!1,r.enabled=!0;var o=n.enabled(e)?r:t;return o.namespace=e,o}function o(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),i=t.length,r=0;i>r;r++)t[r]&&(e=t[r].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function a(){n.enable("")}function s(e){var t,i;for(t=0,i=n.skips.length;i>t;t++)if(n.skips[t].test(e))return!1;for(t=0,i=n.names.length;i>t;t++)if(n.names[t].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=r,n.coerce=c,n.disable=a,n.enable=o,n.enabled=s,n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var u,l=0},{ms:24}],24:[function(e,t){function n(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"y":return n*l;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"h":return n*c;case"minutes":case"minute":case"m":return n*s;case"seconds":case"second":case"s":return n*a;case"ms":return n}}}function i(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function r(e){return o(e,u,"day")||o(e,c,"hour")||o(e,s,"minute")||o(e,a,"second")||e+" ms"}function o(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a=1e3,s=60*a,c=60*s,u=24*c,l=365.25*u;t.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t.long?r(e):i(e)}},{}],25:[function(e,t,n){(function(t){function i(e,t){var i="b"+n.packets[e.type]+e.data.data;return t(i)}function r(e,t,i){if(!t)return n.encodeBase64Packet(e,i);var r=e.data,o=new Uint8Array(r),a=new Uint8Array(1+r.byteLength);a[0]=v[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return i(a.buffer)}function o(e,t,i){if(!t)return n.encodeBase64Packet(e,i);var r=new FileReader;return r.onload=function(){e.data=r.result,n.encodePacket(e,t,!0,i)},r.readAsArrayBuffer(e.data)}function a(e,t,i){if(!t)return n.encodeBase64Packet(e,i);if(g)return o(e,t,i);var r=new Uint8Array(1);r[0]=v[e.type];var a=new w([r.buffer,e.data]);return i(a)}function s(e,t,n){for(var i=new Array(e.length),r=h(e.length,n),o=function(e,n,r){t(n,function(t,n){i[e]=n,r(t,i)})},a=0;a<e.length;a++)o(a,e[a],r)}var c=e("./keys"),u=e("has-binary"),l=e("arraybuffer.slice"),f=e("base64-arraybuffer"),h=e("after"),d=e("utf8"),p=navigator.userAgent.match(/Android/i),m=/PhantomJS/i.test(navigator.userAgent),g=p||m;n.protocol=3;var v=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},y=c(v),b={type:"error",data:"parser error"},w=e("blob");n.encodePacket=function(e,n,o,s){"function"==typeof n&&(s=n,n=!1),"function"==typeof o&&(s=o,o=null);var c=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&c instanceof ArrayBuffer)return r(e,n,s);if(w&&c instanceof t.Blob)return a(e,n,s);if(c&&c.base64)return i(e,s);var u=v[e.type];return void 0!==e.data&&(u+=o?d.encode(String(e.data)):String(e.data)),s(""+u)},n.encodeBase64Packet=function(e,i){var r="b"+n.packets[e.type];if(w&&e.data instanceof w){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];i(r+e)},o.readAsDataURL(e.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(s){for(var c=new Uint8Array(e.data),u=new Array(c.length),l=0;l<c.length;l++)u[l]=c[l];a=String.fromCharCode.apply(null,u)}return r+=t.btoa(a),i(r)},n.decodePacket=function(e,t,i){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return n.decodeBase64Packet(e.substr(1),t);if(i)try{e=d.decode(e)}catch(r){return b}var o=e.charAt(0);return Number(o)==o&&y[o]?e.length>1?{type:y[o],data:e.substring(1)}:{type:y[o]}:b}var a=new Uint8Array(e),o=a[0],s=l(e,1);return w&&"blob"===t&&(s=new w([s])),{type:y[o],data:s}},n.decodeBase64Packet=function(e,n){var i=y[e.charAt(0)];if(!t.ArrayBuffer)return{type:i,data:{base64:!0,data:e.substr(1)}};var r=f.decode(e.substr(1));return"blob"===n&&w&&(r=new w([r])),{type:i,data:r}},n.encodePayload=function(e,t,i){function r(e){return e.length+":"+e}function o(e,i){n.encodePacket(e,a?t:!1,!0,function(e){i(null,r(e))})}"function"==typeof t&&(i=t,t=null);var a=u(e);return t&&a?w&&!g?n.encodePayloadAsBlob(e,i):n.encodePayloadAsArrayBuffer(e,i):e.length?void s(e,o,function(e,t){return i(t.join(""))}):i("0:")},n.decodePayload=function(e,t,i){if("string"!=typeof e)return n.decodePayloadAsBinary(e,t,i);"function"==typeof t&&(i=t,t=null);var r;if(""==e)return i(b,0,1);for(var o,a,s="",c=0,u=e.length;u>c;c++){var l=e.charAt(c);if(":"!=l)s+=l;else{if(""==s||s!=(o=Number(s)))return i(b,0,1);if(a=e.substr(c+1,o),s!=a.length)return i(b,0,1);if(a.length){if(r=n.decodePacket(a,t,!0),b.type==r.type&&b.data==r.data)return i(b,0,1);var f=i(r,c+o,u);if(!1===f)return}c+=o,s=""}}return""!=s?i(b,0,1):void 0},n.encodePayloadAsArrayBuffer=function(e,t){function i(e,t){n.encodePacket(e,!0,!0,function(e){return t(null,e)})}return e.length?void s(e,i,function(e,n){var i=n.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),r=new Uint8Array(i),o=0;return n.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var i=new Uint8Array(e.length),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);n=i.buffer}r[o++]=t?0:1;for(var s=n.byteLength.toString(),a=0;a<s.length;a++)r[o++]=parseInt(s[a]);r[o++]=255;for(var i=new Uint8Array(n),a=0;a<i.length;a++)r[o++]=i[a]}),t(r.buffer)}):t(new ArrayBuffer(0))},n.encodePayloadAsBlob=function(e,t){function i(e,t){n.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof e){for(var i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);e=i.buffer,n[0]=0}for(var o=e instanceof ArrayBuffer?e.byteLength:e.size,a=o.toString(),s=new Uint8Array(a.length+1),r=0;r<a.length;r++)s[r]=parseInt(a[r]);if(s[a.length]=255,w){var c=new w([n.buffer,s.buffer,e]);t(null,c)}})}s(e,i,function(e,n){return t(new w(n))})},n.decodePayloadAsBinary=function(e,t,i){"function"==typeof t&&(i=t,t=null);for(var r=e,o=[],a=!1;r.byteLength>0;){for(var s=new Uint8Array(r),c=0===s[0],u="",f=1;255!=s[f];f++){if(u.length>310){a=!0;break}u+=s[f]}if(a)return i(b,0,1);r=l(r,2+u.length),u=parseInt(u);var h=l(r,0,u);if(c)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(d){var p=new Uint8Array(h);h="";for(var f=0;f<p.length;f++)h+=String.fromCharCode(p[f])}o.push(h),r=l(r,u)}var m=o.length;o.forEach(function(e,r){i(n.decodePacket(e,t,!0),r,m)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(e,t){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var i in e)n.call(e,i)&&t.push(i);return t}},{}],27:[function(e,t){function n(e,t,n){function r(e,i){if(r.count<=0)throw new Error("after called too many times");--r.count,e?(o=!0,t(e),t=n):0!==r.count||o||t(null,i)}var o=!1;return n=n||i,r.count=e,0===e?t():r}function i(){}t.exports=n},{}],28:[function(e,t){t.exports=function(e,t,n){var i=e.byteLength;if(t=t||0,n=n||i,e.slice)return e.slice(t,n);if(0>t&&(t+=i),0>n&&(n+=i),n>i&&(n=i),t>=i||t>=n||0===i)return new ArrayBuffer(0);for(var r=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;n>a;a++,s++)o[s]=r[a];return o.buffer}},{}],29:[function(e,t,n){!function(e){"use strict";n.encode=function(t){var n,i=new Uint8Array(t),r=i.length,o="";for(n=0;r>n;n+=3)o+=e[i[n]>>2],o+=e[(3&i[n])<<4|i[n+1]>>4],o+=e[(15&i[n+1])<<2|i[n+2]>>6],o+=e[63&i[n+2]];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},n.decode=function(t){var n,i,r,o,a,s=.75*t.length,c=t.length,u=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var l=new ArrayBuffer(s),f=new Uint8Array(l);for(n=0;c>n;n+=4)i=e.indexOf(t[n]),r=e.indexOf(t[n+1]),o=e.indexOf(t[n+2]),a=e.indexOf(t[n+3]),f[u++]=i<<2|r>>4,f[u++]=(15&r)<<4|o>>2,f[u++]=(3&o)<<6|63&a;return l}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(e,t){(function(e){function n(e,t){t=t||{};for(var n=new i,r=0;r<e.length;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,r=function(){try{var e=new Blob(["hi"]);return 2==e.size}catch(t){return!1}}(),o=i&&i.prototype.append&&i.prototype.getBlob;t.exports=function(){return r?e.Blob:o?n:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(e,t){(function(n){function i(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(r(e)){for(var i=0;i<e.length;i++)if(t(e[i]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var o in e)if(e.hasOwnProperty(o)&&t(e[o]))return!0}return!1}return t(e)}var r=e("isarray");t.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:32}],32:[function(e,t){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],33:[function(t,n,i){(function(t){!function(r){function o(e){for(var t,n,i=[],r=0,o=e.length;o>r;)t=e.charCodeAt(r++),t>=55296&&56319>=t&&o>r?(n=e.charCodeAt(r++),56320==(64512&n)?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--)):i.push(t);return i}function a(e){for(var t,n=e.length,i=-1,r="";++i<n;)t=e[i],t>65535&&(t-=65536,r+=b(t>>>10&1023|55296),t=56320|1023&t),r+=b(t);return r}function s(e,t){return b(e>>t&63|128)}function c(e){if(0==(4294967168&e))return b(e);var t="";return 0==(4294965248&e)?t=b(e>>6&31|192):0==(4294901760&e)?(t=b(e>>12&15|224),t+=s(e,6)):0==(4292870144&e)&&(t=b(e>>18&7|240),t+=s(e,12),t+=s(e,6)),t+=b(63&e|128)}function u(e){for(var t,n=o(e),i=n.length,r=-1,a="";++r<i;)t=n[r],a+=c(t);return a}function l(){if(y>=v)throw Error("Invalid byte index");var e=255&g[y];if(y++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function f(){var e,t,n,i,r;if(y>v)throw Error("Invalid byte index");if(y==v)return!1;if(e=255&g[y],y++,0==(128&e))return e;if(192==(224&e)){var t=l();if(r=(31&e)<<6|t,r>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=l(),n=l(),r=(15&e)<<12|t<<6|n,r>=2048)return r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=l(),n=l(),i=l(),r=(15&e)<<18|t<<12|n<<6|i,r>=65536&&1114111>=r))return r;throw Error("Invalid UTF-8 detected")}function h(e){g=o(e),v=g.length,y=0;for(var t,n=[];(t=f())!==!1;)n.push(t);return a(n)}var d="object"==typeof i&&i,p="object"==typeof n&&n&&n.exports==d&&n,m="object"==typeof t&&t;(m.global===m||m.window===m)&&(r=m);var g,v,y,b=String.fromCharCode,w={version:"2.0.0",encode:u,decode:h};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return w});else if(d&&!d.nodeType)if(p)p.exports=w;else{var _={},k=_.hasOwnProperty;for(var x in w)k.call(w,x)&&(d[x]=w[x])}else r.utf8=w}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(e,t){(function(e){var n=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(a,"").replace(s,""),e.JSON&&JSON.parse?JSON.parse(t):n.test(t.replace(i,"@").replace(r,"]").replace(o,""))?new Function("return "+t)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),i=0,r=n.length;r>i;i++){var o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},{}],36:[function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,r=e.indexOf("["),o=e.indexOf("]");-1!=r&&-1!=o&&(e=e.substring(0,r)+e.substring(r,o).replace(/:/g,";")+e.substring(o,e.length));for(var a=n.exec(e||""),s={},c=14;c--;)s[i[c]]=a[c]||"";return-1!=r&&-1!=o&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},{}],37:[function(e,t){function n(e,t){var n;return n=t?new r(e,t):new r(e)}var i=function(){return this}(),r=i.WebSocket||i.MozWebSocket;t.exports=r?n:null,r&&(n.prototype=r.prototype)},{}],38:[function(e,t){(function(n){function i(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(r(e)){for(var i=0;i<e.length;i++)if(t(e[i]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t(e[o]))return!0}return!1}return t(e)}var r=e("isarray");t.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:39}],39:[function(e,t){t.exports=e(32)},{}],40:[function(e,t){var n=e("global");try{t.exports="XMLHttpRequest"in n&&"withCredentials"in new n.XMLHttpRequest}catch(i){t.exports=!1}},{global:41}],41:[function(e,t){t.exports=function(){return this}()},{}],42:[function(e,t){var n=[].indexOf;t.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},{}],43:[function(e,t,n){var i=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},n.values=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(e[n]);return t},n.merge=function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);return e},n.length=function(e){return n.keys(e).length},n.isEmpty=function(e){return 0==n.length(e)}},{}],44:[function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){for(var t=n.exec(e||""),r={},o=14;o--;)r[i[o]]=t[o]||"";return r}},{}],45:[function(e,t,n){(function(t){var i=e("isarray"),r=e("./is-buffer");n.deconstructPacket=function(e){function t(e){if(!e)return e;if(r(e)){var o={_placeholder:!0,num:n.length};return n.push(e),o}if(i(e)){for(var a=new Array(e.length),s=0;s<e.length;s++)a[s]=t(e[s]);return a}if("object"==typeof e&&!(e instanceof Date)){var a={};for(var c in e)a[c]=t(e[c]);return a}return e}var n=[],o=e.data,a=e;return a.data=t(o),a.attachments=n.length,{packet:a,buffers:n}},n.reconstructPacket=function(e,t){function n(e){if(e&&e._placeholder){var r=t[e.num];return r}if(i(e)){for(var o=0;o<e.length;o++)e[o]=n(e[o]);return e}if(e&&"object"==typeof e){for(var a in e)e[a]=n(e[a]);return e}return e}return e.data=n(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,n){function o(e,c,u){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){a++;var l=new FileReader;l.onload=function(){u?u[c]=this.result:s=this.result,--a||n(s)},l.readAsArrayBuffer(e)}else if(i(e))for(var f=0;f<e.length;f++)o(e[f],f,e);else if(e&&"object"==typeof e&&!r(e))for(var h in e)o(e[h],h,e)}var a=0,s=e;o(s),a||n(s)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(e,t,n){function i(){}function r(e){var t="",i=!1;return t+=e.type,(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)&&(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(i=!0,t+=e.nsp),null!=e.id&&(i&&(t+=",",i=!1),t+=e.id),null!=e.data&&(i&&(t+=","),t+=f.stringify(e.data)),l("encoded %j as %s",e,t),t}function o(e,t){function n(e){var n=d.deconstructPacket(e),i=r(n.packet),o=n.buffers;o.unshift(i),t(o)}d.removeBlobs(e,n)}function a(){this.reconstructor=null}function s(e){var t={},i=0;if(t.type=Number(e.charAt(0)),null==n.types[t.type])return u();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){for(var r="";"-"!=e.charAt(++i)&&(r+=e.charAt(i),i+1!=e.length););if(r!=Number(r)||"-"!=e.charAt(i))throw new Error("Illegal attachments");t.attachments=Number(r)}if("/"==e.charAt(i+1))for(t.nsp="";++i;){var o=e.charAt(i);if(","==o)break;if(t.nsp+=o,i+1==e.length)break}else t.nsp="/";var a=e.charAt(i+1);if(""!==a&&Number(a)==a){for(t.id="";++i;){var o=e.charAt(i);if(null==o||Number(o)!=o){--i;break}if(t.id+=e.charAt(i),i+1==e.length)break}t.id=Number(t.id)}if(e.charAt(++i))try{t.data=f.parse(e.substr(i))}catch(s){return u()}return l("decoded %s as %j",e,t),t}function c(e){this.reconPack=e,this.buffers=[]}function u(){return{type:n.ERROR,data:"parser error"}}var l=e("debug")("socket.io-parser"),f=e("json3"),h=(e("isarray"),e("component-emitter")),d=e("./binary"),p=e("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=i,n.Decoder=a,i.prototype.encode=function(e,t){if(l("encoding packet %j",e),n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)o(e,t);else{var i=r(e);t([i])}},h(a.prototype),a.prototype.add=function(e){var t;if("string"==typeof e)t=s(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new c(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!p(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=d.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(e,t){(function(e){function n(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],48:[function(e,t){t.exports=e(32)},{}],49:[function(t,n,i){!function(t){function n(e){if(n[e]!==a)return n[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=n("json-stringify")&&n("json-parse");else{var i,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var o=l.stringify,c="function"==typeof o&&f;if(c){(i=function(){return 1}).toJSON=i;try{c="0"===o(0)&&"0"===o(new Number)&&'""'==o(new String)&&o(s)===a&&o(a)===a&&o()===a&&"1"===o(i)&&"[1]"==o([i])&&"[null]"==o([a])&&"null"==o(null)&&"[null,null,null]"==o([a,s,null])&&o({a:[i,!0,!1,null,"\x00\b\n\f\r	"]})==r&&"1"===o(null,i)&&"[\n 1,\n 2\n]"==o([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==o(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==o(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==o(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==o(new Date(-1))}catch(u){c=!1}}t=c}if("json-parse"==e){var h=l.parse;if("function"==typeof h)try{if(0===h("0")&&!h(!1)){i=h(r);var d=5==i.a.length&&1===i.a[0];if(d){try{d=!h('"	"')}catch(u){}if(d)try{d=1!==h("01")}catch(u){}if(d)try{d=1!==h("1.")}catch(u){}}}}catch(u){d=!1}t=d}}return n[e]=!!t}var r,o,a,s={}.toString,c="function"==typeof e&&e.amd,u="object"==typeof JSON&&JSON,l="object"==typeof i&&i&&!i.nodeType&&i;l&&u?(l.stringify=u.stringify,l.parse=u.parse):l=t.JSON=u||{};var f=new Date(-0xc782b5b800cec);try{f=-109252==f.getUTCFullYear()&&0===f.getUTCMonth()&&1===f.getUTCDate()&&10==f.getUTCHours()&&37==f.getUTCMinutes()&&6==f.getUTCSeconds()&&708==f.getUTCMilliseconds()}catch(h){}if(!n("json")){var d="[object Function]",p="[object Date]",m="[object Number]",g="[object String]",v="[object Array]",y="[object Boolean]",b=n("bug-string-char-index");if(!f)var w=Math.floor,_=[0,31,59,90,120,151,181,212,243,273,304,334],k=function(e,t){return _[t]+365*(e-1970)+w((e-1969+(t=+(t>1)))/4)-w((e-1901+t)/100)+w((e-1601+t)/400)};(r={}.hasOwnProperty)||(r=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=s?r=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,r=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,r.call(this,e)});var x={"boolean":1,number:1,string:1,undefined:1},S=function(e,t){var n=typeof e[t];return"object"==n?!!e[t]:!x[n]};if(o=function(e,t){var n,i,a,c=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,i=new n;for(a in i)r.call(i,a)&&c++;return n=i=null,c?o=2==c?function(e,t){var n,i={},o=s.call(e)==d;for(n in e)o&&"prototype"==n||r.call(i,n)||!(i[n]=1)||!r.call(e,n)||t(n)}:function(e,t){var n,i,o=s.call(e)==d;for(n in e)o&&"prototype"==n||!r.call(e,n)||(i="constructor"===n)||t(n);(i||r.call(e,n="constructor"))&&t(n)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],o=function(e,t){var n,o,a=s.call(e)==d,c=!a&&"function"!=typeof e.constructor&&S(e,"hasOwnProperty")?e.hasOwnProperty:r;for(n in e)a&&"prototype"==n||!c.call(e,n)||t(n);for(o=i.length;n=i[--o];c.call(e,n)&&t(n));}),o(e,t)},!n("json-stringify")){var T={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},C="000000",E=function(e,t){return(C+(t||0)).slice(-e)},O="\\u00",A=function(e){var t,n='"',i=0,r=e.length,o=r>10&&b;
for(o&&(t=e.split(""));r>i;i++){var a=e.charCodeAt(i);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=T[a];break;default:if(32>a){n+=O+E(2,a.toString(16));break}n+=o?t[i]:b?e.charAt(i):e[i]}}return n+'"'},P=function(e,t,n,i,c,u,l){var f,h,d,b,_,x,S,T,C,O,I,j,N,B,D,M;try{f=t[e]}catch(R){}if("object"==typeof f&&f)if(h=s.call(f),h!=p||r.call(f,"toJSON"))"function"==typeof f.toJSON&&(h!=m&&h!=g&&h!=v||r.call(f,"toJSON"))&&(f=f.toJSON(e));else if(f>-1/0&&1/0>f){if(k){for(_=w(f/864e5),d=w(_/365.2425)+1970-1;k(d+1,0)<=_;d++);for(b=w((_-k(d,0))/30.42);k(d,b+1)<=_;b++);_=1+_-k(d,b),x=(f%864e5+864e5)%864e5,S=w(x/36e5)%24,T=w(x/6e4)%60,C=w(x/1e3)%60,O=x%1e3}else d=f.getUTCFullYear(),b=f.getUTCMonth(),_=f.getUTCDate(),S=f.getUTCHours(),T=f.getUTCMinutes(),C=f.getUTCSeconds(),O=f.getUTCMilliseconds();f=(0>=d||d>=1e4?(0>d?"-":"+")+E(6,0>d?-d:d):E(4,d))+"-"+E(2,b+1)+"-"+E(2,_)+"T"+E(2,S)+":"+E(2,T)+":"+E(2,C)+"."+E(3,O)+"Z"}else f=null;if(n&&(f=n.call(t,e,f)),null===f)return"null";if(h=s.call(f),h==y)return""+f;if(h==m)return f>-1/0&&1/0>f?""+f:"null";if(h==g)return A(""+f);if("object"==typeof f){for(B=l.length;B--;)if(l[B]===f)throw TypeError();if(l.push(f),I=[],D=u,u+=c,h==v){for(N=0,B=f.length;B>N;N++)j=P(N,f,n,i,c,u,l),I.push(j===a?"null":j);M=I.length?c?"[\n"+u+I.join(",\n"+u)+"\n"+D+"]":"["+I.join(",")+"]":"[]"}else o(i||f,function(e){var t=P(e,f,n,i,c,u,l);t!==a&&I.push(A(e)+":"+(c?" ":"")+t)}),M=I.length?c?"{\n"+u+I.join(",\n"+u)+"\n"+D+"}":"{"+I.join(",")+"}":"{}";return l.pop(),M}};l.stringify=function(e,t,n){var i,r,o,a;if("function"==typeof t||"object"==typeof t&&t)if((a=s.call(t))==d)r=t;else if(a==v){o={};for(var c,u=0,l=t.length;l>u;c=t[u++],a=s.call(c),(a==g||a==m)&&(o[c]=1));}if(n)if((a=s.call(n))==m){if((n-=n%1)>0)for(i="",n>10&&(n=10);i.length<n;i+=" ");}else a==g&&(i=n.length<=10?n:n.slice(0,10));return P("",(c={},c[""]=e,c),r,o,i,"",[])}}if(!n("json-parse")){var I,j,N=String.fromCharCode,B={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},D=function(){throw I=j=null,SyntaxError()},M=function(){for(var e,t,n,i,r,o=j,a=o.length;a>I;)switch(r=o.charCodeAt(I)){case 9:case 10:case 13:case 32:I++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=b?o.charAt(I):o[I],I++,e;case 34:for(e="@",I++;a>I;)if(r=o.charCodeAt(I),32>r)D();else if(92==r)switch(r=o.charCodeAt(++I)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=B[r],I++;break;case 117:for(t=++I,n=I+4;n>I;I++)r=o.charCodeAt(I),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||D();e+=N("0x"+o.slice(t,I));break;default:D()}else{if(34==r)break;for(r=o.charCodeAt(I),t=I;r>=32&&92!=r&&34!=r;)r=o.charCodeAt(++I);e+=o.slice(t,I)}if(34==o.charCodeAt(I))return I++,e;D();default:if(t=I,45==r&&(i=!0,r=o.charCodeAt(++I)),r>=48&&57>=r){for(48==r&&(r=o.charCodeAt(I+1),r>=48&&57>=r)&&D(),i=!1;a>I&&(r=o.charCodeAt(I),r>=48&&57>=r);I++);if(46==o.charCodeAt(I)){for(n=++I;a>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==I&&D(),I=n}if(r=o.charCodeAt(I),101==r||69==r){for(r=o.charCodeAt(++I),(43==r||45==r)&&I++,n=I;a>n&&(r=o.charCodeAt(n),r>=48&&57>=r);n++);n==I&&D(),I=n}return+o.slice(t,I)}if(i&&D(),"true"==o.slice(I,I+4))return I+=4,!0;if("false"==o.slice(I,I+5))return I+=5,!1;if("null"==o.slice(I,I+4))return I+=4,null;D()}return"$"},R=function(e){var t,n;if("$"==e&&D(),"string"==typeof e){if("@"==(b?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=M(),"]"!=e;n||(n=!0))n&&(","==e?(e=M(),"]"==e&&D()):D()),","==e&&D(),t.push(R(e));return t}if("{"==e){for(t={};e=M(),"}"!=e;n||(n=!0))n&&(","==e?(e=M(),"}"==e&&D()):D()),(","==e||"string"!=typeof e||"@"!=(b?e.charAt(0):e[0])||":"!=M())&&D(),t[e.slice(1)]=R(M());return t}D()}return e},L=function(e,t,n){var i=q(e,t,n);i===a?delete e[t]:e[t]=i},q=function(e,t,n){var i,r=e[t];if("object"==typeof r&&r)if(s.call(r)==v)for(i=r.length;i--;)L(r,i,n);else o(r,function(e){L(r,e,n)});return n.call(e,t,r)};l.parse=function(e,t){var n,i;return I=0,j=""+e,n=R(M()),"$"!=M()&&D(),I=j=null,t&&s.call(t)==d?q((i={},i[""]=n,i),"",t):n}}}c&&e(function(){return l})}(this)},{}],50:[function(e,t){function n(e,t){var n=[];t=t||0;for(var i=t||0;i<e.length;i++)n[i-t]=e[i];return n}t.exports=n},{}]},{},[1])(1)}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.pako=e()}}(function(){return function e(t,n,i){function r(a,s){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=n[a]={exports:{}};t[a][0].call(u.exports,function(e){var n=t[a][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)r(i[a]);return r}({1:[function(e,t){"use strict";var n=e("./lib/utils/common").assign,i=e("./lib/deflate"),r=e("./lib/inflate"),o=e("./lib/zlib/constants"),a={};n(a,i,r,o),t.exports=a},{"./lib/deflate":2,"./lib/inflate":3,"./lib/utils/common":4,"./lib/zlib/constants":7}],2:[function(e,t,n){"use strict";function i(e,t){var n=new y(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function r(e,t){return t=t||{},t.raw=!0,i(e,t)}function o(e,t){return t=t||{},t.gzip=!0,i(e,t)}var a=e("./zlib/deflate.js"),s=e("./utils/common"),c=e("./utils/strings"),u=e("./zlib/messages"),l=e("./zlib/zstream"),f=0,h=4,d=0,p=1,m=-1,g=0,v=8,y=function(e){this.options=s.assign({level:m,method:v,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==d)throw new Error(u[n]);t.header&&a.deflateSetHeader(this.strm,t.header)};y.prototype.push=function(e,t){var n,i,r=this.strm,o=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:t===!0?h:f,r.input="string"==typeof e?c.string2buf(e):e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new s.Buf8(o),r.next_out=0,r.avail_out=o),n=a.deflate(r,i),n!==p&&n!==d)return this.onEnd(n),this.ended=!0,!1;(0===r.avail_out||0===r.avail_in&&i===h)&&this.onData("string"===this.options.to?c.buf2binstring(s.shrinkBuf(r.output,r.next_out)):s.shrinkBuf(r.output,r.next_out))}while((r.avail_in>0||0===r.avail_out)&&n!==p);return i===h?(n=a.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===d):!0},y.prototype.onData=function(e){this.chunks.push(e)},y.prototype.onEnd=function(e){e===d&&(this.result="string"===this.options.to?this.chunks.join(""):s.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=y,n.deflate=i,n.deflateRaw=r,n.gzip=o},{"./utils/common":4,"./utils/strings":5,"./zlib/deflate.js":9,"./zlib/messages":14,"./zlib/zstream":16}],3:[function(e,t,n){"use strict";function i(e,t){var n=new h(t);if(n.push(e,!0),n.err)throw n.msg;return n.result}function r(e,t){return t=t||{},t.raw=!0,i(e,t)}var o=e("./zlib/inflate.js"),a=e("./utils/common"),s=e("./utils/strings"),c=e("./zlib/constants"),u=e("./zlib/messages"),l=e("./zlib/zstream"),f=e("./zlib/gzheader"),h=function(e){this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=o.inflateInit2(this.strm,t.windowBits);if(n!==c.Z_OK)throw new Error(u[n]);this.header=new f,o.inflateGetHeader(this.strm,this.header)};h.prototype.push=function(e,t){var n,i,r,u,l,f=this.strm,h=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:t===!0?c.Z_FINISH:c.Z_NO_FLUSH,f.input="string"==typeof e?s.binstring2buf(e):e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new a.Buf8(h),f.next_out=0,f.avail_out=h),n=o.inflate(f,c.Z_NO_FLUSH),n!==c.Z_STREAM_END&&n!==c.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0===f.avail_out||n===c.Z_STREAM_END||0===f.avail_in&&i===c.Z_FINISH)&&("string"===this.options.to?(r=s.utf8border(f.output,f.next_out),u=f.next_out-r,l=s.buf2string(f.output,r),f.next_out=u,f.avail_out=h-u,u&&a.arraySet(f.output,f.output,r,u,0),this.onData(l)):this.onData(a.shrinkBuf(f.output,f.next_out)))}while(f.avail_in>0&&n!==c.Z_STREAM_END);return n===c.Z_STREAM_END&&(i=c.Z_FINISH),i===c.Z_FINISH?(n=o.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===c.Z_OK):!0},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===c.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=h,n.inflate=i,n.inflateRaw=r,n.ungzip=i},{"./utils/common":4,"./utils/strings":5,"./zlib/constants":7,"./zlib/gzheader":10,"./zlib/inflate.js":12,"./zlib/messages":14,"./zlib/zstream":16}],4:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)return void e.set(t.subarray(n,n+i),r);for(var o=0;i>o;o++)e[r+o]=t[n+o]},flattenChunks:function(e){var t,n,i,r,o,a;for(i=0,t=0,n=e.length;n>t;t++)i+=e[t].length;for(a=new Uint8Array(i),r=0,t=0,n=e.length;n>t;t++)o=e[t],a.set(o,r),r+=o.length;return a}},o={arraySet:function(e,t,n,i,r){for(var o=0;i>o;o++)e[r+o]=t[n+o]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},{}],5:[function(e,t,n){"use strict";function i(e,t){if(65537>t&&(e.subarray&&a||!e.subarray&&o))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",i=0;t>i;i++)n+=String.fromCharCode(e[i]);return n}var r=e("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(s){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){a=!1}for(var c=new r.Buf8(256),u=0;256>u;u++)c[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;c[254]=c[254]=1,n.string2buf=function(e){var t,n,i,o,a,s=e.length,c=0;for(o=0;s>o;o++)n=e.charCodeAt(o),55296===(64512&n)&&s>o+1&&(i=e.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),c+=128>n?1:2048>n?2:65536>n?3:4;for(t=new r.Buf8(c),a=0,o=0;c>a;o++)n=e.charCodeAt(o),55296===(64512&n)&&s>o+1&&(i=e.charCodeAt(o+1),56320===(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),o++)),128>n?t[a++]=n:2048>n?(t[a++]=192|n>>>6,t[a++]=128|63&n):65536>n?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},n.buf2binstring=function(e){return i(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;i>n;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,o,a,s=t||e.length,u=new Array(2*s);for(r=0,n=0;s>n;)if(o=e[n++],128>o)u[r++]=o;else if(a=c[o],a>4)u[r++]=65533,n+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&s>n;)o=o<<6|63&e[n++],a--;a>1?u[r++]=65533:65536>o?u[r++]=o:(o-=65536,u[r++]=55296|o>>10&1023,u[r++]=56320|1023&o)}return i(u,r)},n.utf8border=function(e,t){var n;for(t=t||e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&128===(192&e[n]);)n--;return 0>n?t:0===n?t:n+c[e[n]]>t?n:t}},{"./common":4}],6:[function(e,t){"use strict";function n(e,t,n,i){for(var r=65535&e|0,o=e>>>16&65535|0,a=0;0!==n;){a=n>2e3?2e3:n,n-=a;do r=r+t[i++]|0,o=o+r|0;while(--a);r%=65521,o%=65521}return r|o<<16|0}t.exports=n},{}],7:[function(e,t){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],8:[function(e,t){"use strict";function n(){for(var e,t=[],n=0;256>n;n++){e=n;for(var i=0;8>i;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}function i(e,t,n,i){var o=r,a=i+n;e=-1^e;for(var s=i;a>s;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}var r=n();t.exports=i},{}],9:[function(e,t,n){"use strict";function i(e,t){return e.msg=j[t],t}function r(e){return(e<<1)-(e>4?9:0)}function o(e){for(var t=e.length;--t>=0;)e[t]=0}function a(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(O.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function s(e,t){A._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,a(e.strm)}function c(e,t){e.pending_buf[e.pending++]=t}function u(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function l(e,t,n,i){var r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,O.arraySet(t,e.input,e.next_in,r,n),1===e.state.wrap?e.adler=P(e.adler,t,r,n):2===e.state.wrap&&(e.adler=I(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)}function f(e,t){var n,i,r=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-ut?e.strstart-(e.w_size-ut):0,u=e.window,l=e.w_mask,f=e.prev,h=e.strstart+ct,d=u[o+a-1],p=u[o+a];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do if(n=t,u[n+a]===p&&u[n+a-1]===d&&u[n]===u[o]&&u[++n]===u[o+1]){o+=2,n++;do;while(u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&u[++o]===u[++n]&&h>o);if(i=ct-(h-o),o=h-ct,i>a){if(e.match_start=t,a=i,i>=s)break;d=u[o+a-1],p=u[o+a]}}while((t=f[t&l])>c&&0!==--r);return a<=e.lookahead?a:e.lookahead}function h(e){var t,n,i,r,o,a=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=a+(a-ut)){O.arraySet(e.window,e.window,a,a,0),e.match_start-=a,e.strstart-=a,e.block_start-=a,n=e.hash_size,t=n;do i=e.head[--t],e.head[t]=i>=a?i-a:0;while(--n);n=a,t=n;do i=e.prev[--t],e.prev[t]=i>=a?i-a:0;while(--n);r+=a}if(0===e.strm.avail_in)break;if(n=l(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=st)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+st-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<st)););}while(e.lookahead<ut&&0!==e.strm.avail_in)}function d(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(h(e),0===e.lookahead&&t===N)return yt;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,s(e,!1),0===e.strm.avail_out))return yt;if(e.strstart-e.block_start>=e.w_size-ut&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=0,t===M?(s(e,!0),0===e.strm.avail_out?wt:_t):e.strstart>e.block_start&&(s(e,!1),0===e.strm.avail_out)?yt:yt}function p(e,t){for(var n,i;;){if(e.lookahead<ut){if(h(e),e.lookahead<ut&&t===N)return yt;if(0===e.lookahead)break}if(n=0,e.lookahead>=st&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-ut&&(e.match_length=f(e,n)),e.match_length>=st)if(i=A._tr_tally(e,e.strstart-e.match_start,e.match_length-st),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=st){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=A._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=e.strstart<st-1?e.strstart:st-1,t===M?(s(e,!0),0===e.strm.avail_out?wt:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function m(e,t){for(var n,i,r;;){if(e.lookahead<ut){if(h(e),e.lookahead<ut&&t===N)return yt;if(0===e.lookahead)break}if(n=0,e.lookahead>=st&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=st-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-ut&&(e.match_length=f(e,n),e.match_length<=5&&(e.strategy===H||e.match_length===st&&e.strstart-e.match_start>4096)&&(e.match_length=st-1)),e.prev_length>=st&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-st,i=A._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-st),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+st-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(0!==--e.prev_length);if(e.match_available=0,e.match_length=st-1,e.strstart++,i&&(s(e,!1),0===e.strm.avail_out))return yt}else if(e.match_available){if(i=A._tr_tally(e,0,e.window[e.strstart-1]),i&&s(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return yt}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=A._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<st-1?e.strstart:st-1,t===M?(s(e,!0),0===e.strm.avail_out?wt:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function g(e,t){for(var n,i,r,o,a=e.window;;){if(e.lookahead<=ct){if(h(e),e.lookahead<=ct&&t===N)return yt;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=st&&e.strstart>0&&(r=e.strstart-1,i=a[r],i===a[++r]&&i===a[++r]&&i===a[++r])){o=e.strstart+ct;do;while(i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&i===a[++r]&&o>r);e.match_length=ct-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=st?(n=A._tr_tally(e,1,e.match_length-st),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=A._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=0,t===M?(s(e,!0),0===e.strm.avail_out?wt:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function v(e,t){for(var n;;){if(0===e.lookahead&&(h(e),0===e.lookahead)){if(t===N)return yt;break}if(e.match_length=0,n=A._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(s(e,!1),0===e.strm.avail_out))return yt}return e.insert=0,t===M?(s(e,!0),0===e.strm.avail_out?wt:_t):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?yt:bt}function y(e){e.window_size=2*e.w_size,o(e.head),e.max_lazy_match=E[e.level].max_lazy,e.good_match=E[e.level].good_length,e.nice_match=E[e.level].nice_length,e.max_chain_length=E[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=st-1,e.match_available=0,e.ins_h=0}function b(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=G,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new O.Buf16(2*ot),this.dyn_dtree=new O.Buf16(2*(2*it+1)),this.bl_tree=new O.Buf16(2*(2*rt+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new O.Buf16(at+1),this.heap=new O.Buf16(2*nt+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new O.Buf16(2*nt+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=K,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?ft:gt,e.adler=2===t.wrap?0:1,t.last_flush=N,A._tr_init(t),L):i(e,z)}function _(e){var t=w(e);return t===L&&y(e.state),t}function k(e,t){return e&&e.state?2!==e.state.wrap?z:(e.state.gzhead=t,L):z}function x(e,t,n,r,o,a){if(!e)return z;var s=1;if(t===F&&(t=6),0>r?(s=0,r=-r):r>15&&(s=2,r-=16),1>o||o>Y||n!==G||8>r||r>15||0>t||t>9||0>a||a>W)return i(e,z);8===r&&(r=9);var c=new b;return e.state=c,c.strm=e,c.wrap=s,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=o+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+st-1)/st),c.window=new O.Buf8(2*c.w_size),c.head=new O.Buf16(c.hash_size),c.prev=new O.Buf16(c.w_size),c.lit_bufsize=1<<o+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new O.Buf8(c.pending_buf_size),c.d_buf=c.lit_bufsize>>1,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=a,c.method=n,_(e)}function S(e,t){return x(e,t,G,$,Q,Z)}function T(e,t){var n,s,l,f;if(!e||!e.state||t>R||0>t)return e?i(e,z):z;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||s.status===vt&&t!==M)return i(e,0===e.avail_out?V:z);if(s.strm=e,n=s.last_flush,s.last_flush=t,s.status===ft)if(2===s.wrap)e.adler=0,c(s,31),c(s,139),c(s,8),s.gzhead?(c(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),c(s,255&s.gzhead.time),c(s,s.gzhead.time>>8&255),c(s,s.gzhead.time>>16&255),c(s,s.gzhead.time>>24&255),c(s,9===s.level?2:s.strategy>=J||s.level<2?4:0),c(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(c(s,255&s.gzhead.extra.length),c(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=I(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=ht):(c(s,0),c(s,0),c(s,0),c(s,0),c(s,0),c(s,9===s.level?2:s.strategy>=J||s.level<2?4:0),c(s,kt),s.status=gt);else{var h=G+(s.w_bits-8<<4)<<8,d=-1;d=s.strategy>=J||s.level<2?0:s.level<6?1:6===s.level?2:3,h|=d<<6,0!==s.strstart&&(h|=lt),h+=31-h%31,s.status=gt,u(s,h),0!==s.strstart&&(u(s,e.adler>>>16),u(s,65535&e.adler)),e.adler=1}if(s.status===ht)if(s.gzhead.extra){for(l=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>l&&(e.adler=I(e.adler,s.pending_buf,s.pending-l,l)),a(e),l=s.pending,s.pending!==s.pending_buf_size));)c(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>l&&(e.adler=I(e.adler,s.pending_buf,s.pending-l,l)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=dt)}else s.status=dt;if(s.status===dt)if(s.gzhead.name){l=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>l&&(e.adler=I(e.adler,s.pending_buf,s.pending-l,l)),a(e),l=s.pending,s.pending===s.pending_buf_size)){f=1;break}f=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,c(s,f)}while(0!==f);s.gzhead.hcrc&&s.pending>l&&(e.adler=I(e.adler,s.pending_buf,s.pending-l,l)),0===f&&(s.gzindex=0,s.status=pt)}else s.status=pt;if(s.status===pt)if(s.gzhead.comment){l=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>l&&(e.adler=I(e.adler,s.pending_buf,s.pending-l,l)),a(e),l=s.pending,s.pending===s.pending_buf_size)){f=1;break}f=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,c(s,f)}while(0!==f);s.gzhead.hcrc&&s.pending>l&&(e.adler=I(e.adler,s.pending_buf,s.pending-l,l)),0===f&&(s.status=mt)}else s.status=mt;if(s.status===mt&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&a(e),s.pending+2<=s.pending_buf_size&&(c(s,255&e.adler),c(s,e.adler>>8&255),e.adler=0,s.status=gt)):s.status=gt),0!==s.pending){if(a(e),0===e.avail_out)return s.last_flush=-1,L}else if(0===e.avail_in&&r(t)<=r(n)&&t!==M)return i(e,V);if(s.status===vt&&0!==e.avail_in)return i(e,V);if(0!==e.avail_in||0!==s.lookahead||t!==N&&s.status!==vt){var p=s.strategy===J?v(s,t):s.strategy===X?g(s,t):E[s.level].func(s,t);if((p===wt||p===_t)&&(s.status=vt),p===yt||p===wt)return 0===e.avail_out&&(s.last_flush=-1),L;if(p===bt&&(t===B?A._tr_align(s):t!==R&&(A._tr_stored_block(s,0,0,!1),t===D&&(o(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),a(e),0===e.avail_out))return s.last_flush=-1,L}return t!==M?L:s.wrap<=0?q:(2===s.wrap?(c(s,255&e.adler),c(s,e.adler>>8&255),c(s,e.adler>>16&255),c(s,e.adler>>24&255),c(s,255&e.total_in),c(s,e.total_in>>8&255),c(s,e.total_in>>16&255),c(s,e.total_in>>24&255)):(u(s,e.adler>>>16),u(s,65535&e.adler)),a(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?L:q)}function C(e){var t;return e&&e.state?(t=e.state.status,t!==ft&&t!==ht&&t!==dt&&t!==pt&&t!==mt&&t!==gt&&t!==vt?i(e,z):(e.state=null,t===gt?i(e,U):L)):z}var E,O=e("../utils/common"),A=e("./trees"),P=e("./adler32"),I=e("./crc32"),j=e("./messages"),N=0,B=1,D=3,M=4,R=5,L=0,q=1,z=-2,U=-3,V=-5,F=-1,H=1,J=2,X=3,W=4,Z=0,K=2,G=8,Y=9,$=15,Q=8,et=29,tt=256,nt=tt+1+et,it=30,rt=19,ot=2*nt+1,at=15,st=3,ct=258,ut=ct+st+1,lt=32,ft=42,ht=69,dt=73,pt=91,mt=103,gt=113,vt=666,yt=1,bt=2,wt=3,_t=4,kt=3,xt=function(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r};E=[new xt(0,0,0,0,d),new xt(4,4,8,4,p),new xt(4,5,16,8,p),new xt(4,6,32,32,p),new xt(4,4,16,16,m),new xt(8,16,32,32,m),new xt(8,16,128,128,m),new xt(8,32,128,256,m),new xt(32,128,258,1024,m),new xt(32,258,258,4096,m)],n.deflateInit=S,n.deflateInit2=x,n.deflateReset=_,n.deflateResetKeep=w,n.deflateSetHeader=k,n.deflate=T,n.deflateEnd=C,n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":4,"./adler32":6,"./crc32":8,"./messages":14,"./trees":15}],10:[function(e,t){"use strict";function n(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=n},{}],11:[function(e,t){"use strict";var n=30,i=12;t.exports=function(e,t){var r,o,a,s,c,u,l,f,h,d,p,m,g,v,y,b,w,_,k,x,S,T,C,E,O;r=e.state,o=e.next_in,E=e.input,a=o+(e.avail_in-5),s=e.next_out,O=e.output,c=s-(t-e.avail_out),u=s+(e.avail_out-257),l=r.dmax,f=r.wsize,h=r.whave,d=r.wnext,p=r.window,m=r.hold,g=r.bits,v=r.lencode,y=r.distcode,b=(1<<r.lenbits)-1,w=(1<<r.distbits)-1;e:do{15>g&&(m+=E[o++]<<g,g+=8,m+=E[o++]<<g,g+=8),_=v[m&b];t:for(;;){if(k=_>>>24,m>>>=k,g-=k,k=_>>>16&255,0===k)O[s++]=65535&_;else{if(!(16&k)){if(0===(64&k)){_=v[(65535&_)+(m&(1<<k)-1)];continue t}if(32&k){r.mode=i;break e}e.msg="invalid literal/length code",r.mode=n;break e}x=65535&_,k&=15,k&&(k>g&&(m+=E[o++]<<g,g+=8),x+=m&(1<<k)-1,m>>>=k,g-=k),15>g&&(m+=E[o++]<<g,g+=8,m+=E[o++]<<g,g+=8),_=y[m&w];n:for(;;){if(k=_>>>24,m>>>=k,g-=k,k=_>>>16&255,!(16&k)){if(0===(64&k)){_=y[(65535&_)+(m&(1<<k)-1)];continue n}e.msg="invalid distance code",r.mode=n;break e}if(S=65535&_,k&=15,k>g&&(m+=E[o++]<<g,g+=8,k>g&&(m+=E[o++]<<g,g+=8)),S+=m&(1<<k)-1,S>l){e.msg="invalid distance too far back",r.mode=n;break e}if(m>>>=k,g-=k,k=s-c,S>k){if(k=S-k,k>h&&r.sane){e.msg="invalid distance too far back",r.mode=n;break e}if(T=0,C=p,0===d){if(T+=f-k,x>k){x-=k;do O[s++]=p[T++];while(--k);T=s-S,C=O}}else if(k>d){if(T+=f+d-k,k-=d,x>k){x-=k;do O[s++]=p[T++];while(--k);if(T=0,x>d){k=d,x-=k;do O[s++]=p[T++];while(--k);T=s-S,C=O}}}else if(T+=d-k,x>k){x-=k;do O[s++]=p[T++];while(--k);T=s-S,C=O}for(;x>2;)O[s++]=C[T++],O[s++]=C[T++],O[s++]=C[T++],x-=3;x&&(O[s++]=C[T++],x>1&&(O[s++]=C[T++]))}else{T=s-S;do O[s++]=O[T++],O[s++]=O[T++],O[s++]=O[T++],x-=3;while(x>2);x&&(O[s++]=O[T++],x>1&&(O[s++]=O[T++]))}break}}break}}while(a>o&&u>s);x=g>>3,o-=x,g-=x<<3,m&=(1<<g)-1,e.next_in=o,e.next_out=s,e.avail_in=a>o?5+(a-o):5-(o-a),e.avail_out=u>s?257+(u-s):257-(s-u),r.hold=m,r.bits=g}},{}],12:[function(e,t,n){"use strict";function i(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=M,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new v.Buf32(pt),t.distcode=t.distdyn=new v.Buf32(mt),t.sane=1,t.back=-1,O):I}function a(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,o(e)):I}function s(e,t){var n,i;return e&&e.state?(i=e.state,0>t?(n=0,t=-t):(n=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||t>15)?I:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,a(e))):I}function c(e,t){var n,i;return e?(i=new r,e.state=i,i.window=null,n=s(e,t),n!==O&&(e.state=null),n):I}function u(e){return c(e,vt)}function l(e){if(yt){var t;for(m=new v.Buf32(512),g=new v.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(_(x,e.lens,0,288,m,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;_(S,e.lens,0,32,g,0,e.work,{bits:5}),yt=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function f(e,t,n,i){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new v.Buf8(o.wsize)),i>=o.wsize?(v.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),v.arraySet(o.window,t,n-i,r,o.wnext),i-=r,i?(v.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}function h(e,t){var n,r,o,a,s,c,u,h,d,p,m,g,pt,mt,gt,vt,yt,bt,wt,_t,kt,xt,St,Tt,Ct=0,Et=new v.Buf8(4),Ot=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return I;n=e.state,n.mode===W&&(n.mode=Z),s=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,r=e.input,c=e.avail_in,h=n.hold,d=n.bits,p=c,m=u,xt=O;e:for(;;)switch(n.mode){case M:if(0===n.wrap){n.mode=Z;break}for(;16>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(2&n.wrap&&35615===h){n.check=0,Et[0]=255&h,Et[1]=h>>>8&255,n.check=b(n.check,Et,2,0),h=0,d=0,n.mode=R;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",n.mode=ft;break}if((15&h)!==D){e.msg="unknown compression method",n.mode=ft;break}if(h>>>=4,d-=4,kt=(15&h)+8,0===n.wbits)n.wbits=kt;else if(kt>n.wbits){e.msg="invalid window size",n.mode=ft;break}n.dmax=1<<kt,e.adler=n.check=1,n.mode=512&h?J:W,h=0,d=0;break;case R:for(;16>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(n.flags=h,(255&n.flags)!==D){e.msg="unknown compression method",n.mode=ft;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=ft;break}n.head&&(n.head.text=h>>8&1),512&n.flags&&(Et[0]=255&h,Et[1]=h>>>8&255,n.check=b(n.check,Et,2,0)),h=0,d=0,n.mode=L;
case L:for(;32>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}n.head&&(n.head.time=h),512&n.flags&&(Et[0]=255&h,Et[1]=h>>>8&255,Et[2]=h>>>16&255,Et[3]=h>>>24&255,n.check=b(n.check,Et,4,0)),h=0,d=0,n.mode=q;case q:for(;16>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}n.head&&(n.head.xflags=255&h,n.head.os=h>>8),512&n.flags&&(Et[0]=255&h,Et[1]=h>>>8&255,n.check=b(n.check,Et,2,0)),h=0,d=0,n.mode=z;case z:if(1024&n.flags){for(;16>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}n.length=h,n.head&&(n.head.extra_len=h),512&n.flags&&(Et[0]=255&h,Et[1]=h>>>8&255,n.check=b(n.check,Et,2,0)),h=0,d=0}else n.head&&(n.head.extra=null);n.mode=U;case U:if(1024&n.flags&&(g=n.length,g>c&&(g=c),g&&(n.head&&(kt=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),v.arraySet(n.head.extra,r,a,g,kt)),512&n.flags&&(n.check=b(n.check,r,g,a)),c-=g,a+=g,n.length-=g),n.length))break e;n.length=0,n.mode=V;case V:if(2048&n.flags){if(0===c)break e;g=0;do kt=r[a+g++],n.head&&kt&&n.length<65536&&(n.head.name+=String.fromCharCode(kt));while(kt&&c>g);if(512&n.flags&&(n.check=b(n.check,r,g,a)),c-=g,a+=g,kt)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=F;case F:if(4096&n.flags){if(0===c)break e;g=0;do kt=r[a+g++],n.head&&kt&&n.length<65536&&(n.head.comment+=String.fromCharCode(kt));while(kt&&c>g);if(512&n.flags&&(n.check=b(n.check,r,g,a)),c-=g,a+=g,kt)break e}else n.head&&(n.head.comment=null);n.mode=H;case H:if(512&n.flags){for(;16>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(h!==(65535&n.check)){e.msg="header crc mismatch",n.mode=ft;break}h=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=W;break;case J:for(;32>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}e.adler=n.check=i(h),h=0,d=0,n.mode=X;case X:if(0===n.havedict)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=h,n.bits=d,P;e.adler=n.check=1,n.mode=W;case W:if(t===C||t===E)break e;case Z:if(n.last){h>>>=7&d,d-=7&d,n.mode=ct;break}for(;3>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}switch(n.last=1&h,h>>>=1,d-=1,3&h){case 0:n.mode=K;break;case 1:if(l(n),n.mode=tt,t===E){h>>>=2,d-=2;break e}break;case 2:n.mode=$;break;case 3:e.msg="invalid block type",n.mode=ft}h>>>=2,d-=2;break;case K:for(h>>>=7&d,d-=7&d;32>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if((65535&h)!==(h>>>16^65535)){e.msg="invalid stored block lengths",n.mode=ft;break}if(n.length=65535&h,h=0,d=0,n.mode=G,t===E)break e;case G:n.mode=Y;case Y:if(g=n.length){if(g>c&&(g=c),g>u&&(g=u),0===g)break e;v.arraySet(o,r,a,g,s),c-=g,a+=g,u-=g,s+=g,n.length-=g;break}n.mode=W;break;case $:for(;14>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(n.nlen=(31&h)+257,h>>>=5,d-=5,n.ndist=(31&h)+1,h>>>=5,d-=5,n.ncode=(15&h)+4,h>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=ft;break}n.have=0,n.mode=Q;case Q:for(;n.have<n.ncode;){for(;3>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}n.lens[Ot[n.have++]]=7&h,h>>>=3,d-=3}for(;n.have<19;)n.lens[Ot[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,St={bits:n.lenbits},xt=_(k,n.lens,0,19,n.lencode,0,n.work,St),n.lenbits=St.bits,xt){e.msg="invalid code lengths set",n.mode=ft;break}n.have=0,n.mode=et;case et:for(;n.have<n.nlen+n.ndist;){for(;Ct=n.lencode[h&(1<<n.lenbits)-1],gt=Ct>>>24,vt=Ct>>>16&255,yt=65535&Ct,!(d>=gt);){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(16>yt)h>>>=gt,d-=gt,n.lens[n.have++]=yt;else{if(16===yt){for(Tt=gt+2;Tt>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(h>>>=gt,d-=gt,0===n.have){e.msg="invalid bit length repeat",n.mode=ft;break}kt=n.lens[n.have-1],g=3+(3&h),h>>>=2,d-=2}else if(17===yt){for(Tt=gt+3;Tt>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}h>>>=gt,d-=gt,kt=0,g=3+(7&h),h>>>=3,d-=3}else{for(Tt=gt+7;Tt>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}h>>>=gt,d-=gt,kt=0,g=11+(127&h),h>>>=7,d-=7}if(n.have+g>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=ft;break}for(;g--;)n.lens[n.have++]=kt}}if(n.mode===ft)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=ft;break}if(n.lenbits=9,St={bits:n.lenbits},xt=_(x,n.lens,0,n.nlen,n.lencode,0,n.work,St),n.lenbits=St.bits,xt){e.msg="invalid literal/lengths set",n.mode=ft;break}if(n.distbits=6,n.distcode=n.distdyn,St={bits:n.distbits},xt=_(S,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,St),n.distbits=St.bits,xt){e.msg="invalid distances set",n.mode=ft;break}if(n.mode=tt,t===E)break e;case tt:n.mode=nt;case nt:if(c>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=h,n.bits=d,w(e,m),s=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,r=e.input,c=e.avail_in,h=n.hold,d=n.bits,n.mode===W&&(n.back=-1);break}for(n.back=0;Ct=n.lencode[h&(1<<n.lenbits)-1],gt=Ct>>>24,vt=Ct>>>16&255,yt=65535&Ct,!(d>=gt);){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(vt&&0===(240&vt)){for(bt=gt,wt=vt,_t=yt;Ct=n.lencode[_t+((h&(1<<bt+wt)-1)>>bt)],gt=Ct>>>24,vt=Ct>>>16&255,yt=65535&Ct,!(d>=bt+gt);){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}h>>>=bt,d-=bt,n.back+=bt}if(h>>>=gt,d-=gt,n.back+=gt,n.length=yt,0===vt){n.mode=st;break}if(32&vt){n.back=-1,n.mode=W;break}if(64&vt){e.msg="invalid literal/length code",n.mode=ft;break}n.extra=15&vt,n.mode=it;case it:if(n.extra){for(Tt=n.extra;Tt>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=rt;case rt:for(;Ct=n.distcode[h&(1<<n.distbits)-1],gt=Ct>>>24,vt=Ct>>>16&255,yt=65535&Ct,!(d>=gt);){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(0===(240&vt)){for(bt=gt,wt=vt,_t=yt;Ct=n.distcode[_t+((h&(1<<bt+wt)-1)>>bt)],gt=Ct>>>24,vt=Ct>>>16&255,yt=65535&Ct,!(d>=bt+gt);){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}h>>>=bt,d-=bt,n.back+=bt}if(h>>>=gt,d-=gt,n.back+=gt,64&vt){e.msg="invalid distance code",n.mode=ft;break}n.offset=yt,n.extra=15&vt,n.mode=ot;case ot:if(n.extra){for(Tt=n.extra;Tt>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=ft;break}n.mode=at;case at:if(0===u)break e;if(g=m-u,n.offset>g){if(g=n.offset-g,g>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=ft;break}g>n.wnext?(g-=n.wnext,pt=n.wsize-g):pt=n.wnext-g,g>n.length&&(g=n.length),mt=n.window}else mt=o,pt=s-n.offset,g=n.length;g>u&&(g=u),u-=g,n.length-=g;do o[s++]=mt[pt++];while(--g);0===n.length&&(n.mode=nt);break;case st:if(0===u)break e;o[s++]=n.length,u--,n.mode=nt;break;case ct:if(n.wrap){for(;32>d;){if(0===c)break e;c--,h|=r[a++]<<d,d+=8}if(m-=u,e.total_out+=m,n.total+=m,m&&(e.adler=n.check=n.flags?b(n.check,o,m,s-m):y(n.check,o,m,s-m)),m=u,(n.flags?h:i(h))!==n.check){e.msg="incorrect data check",n.mode=ft;break}h=0,d=0}n.mode=ut;case ut:if(n.wrap&&n.flags){for(;32>d;){if(0===c)break e;c--,h+=r[a++]<<d,d+=8}if(h!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=ft;break}h=0,d=0}n.mode=lt;case lt:xt=A;break e;case ft:xt=j;break e;case ht:return N;case dt:default:return I}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=c,n.hold=h,n.bits=d,(n.wsize||m!==e.avail_out&&n.mode<ft&&(n.mode<ct||t!==T))&&f(e,e.output,e.next_out,m-e.avail_out)?(n.mode=ht,N):(p-=e.avail_in,m-=e.avail_out,e.total_in+=p,e.total_out+=m,n.total+=m,n.wrap&&m&&(e.adler=n.check=n.flags?b(n.check,o,m,e.next_out-m):y(n.check,o,m,e.next_out-m)),e.data_type=n.bits+(n.last?64:0)+(n.mode===W?128:0)+(n.mode===tt||n.mode===G?256:0),(0===p&&0===m||t===T)&&xt===O&&(xt=B),xt)}function d(e){if(!e||!e.state)return I;var t=e.state;return t.window&&(t.window=null),e.state=null,O}function p(e,t){var n;return e&&e.state?(n=e.state,0===(2&n.wrap)?I:(n.head=t,t.done=!1,O)):I}var m,g,v=e("../utils/common"),y=e("./adler32"),b=e("./crc32"),w=e("./inffast"),_=e("./inftrees"),k=0,x=1,S=2,T=4,C=5,E=6,O=0,A=1,P=2,I=-2,j=-3,N=-4,B=-5,D=8,M=1,R=2,L=3,q=4,z=5,U=6,V=7,F=8,H=9,J=10,X=11,W=12,Z=13,K=14,G=15,Y=16,$=17,Q=18,et=19,tt=20,nt=21,it=22,rt=23,ot=24,at=25,st=26,ct=27,ut=28,lt=29,ft=30,ht=31,dt=32,pt=852,mt=592,gt=15,vt=gt,yt=!0;n.inflateReset=a,n.inflateReset2=s,n.inflateResetKeep=o,n.inflateInit=u,n.inflateInit2=c,n.inflate=h,n.inflateEnd=d,n.inflateGetHeader=p,n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":4,"./adler32":6,"./crc32":8,"./inffast":11,"./inftrees":13}],13:[function(e,t){"use strict";var n=e("../utils/common"),i=15,r=852,o=592,a=0,s=1,c=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,d,p,m,g,v,y){var b,w,_,k,x,S,T,C,E,O=y.bits,A=0,P=0,I=0,j=0,N=0,B=0,D=0,M=0,R=0,L=0,q=null,z=0,U=new n.Buf16(i+1),V=new n.Buf16(i+1),F=null,H=0;for(A=0;i>=A;A++)U[A]=0;for(P=0;p>P;P++)U[t[d+P]]++;for(N=O,j=i;j>=1&&0===U[j];j--);if(N>j&&(N=j),0===j)return m[g++]=20971520,m[g++]=20971520,y.bits=1,0;for(I=1;j>I&&0===U[I];I++);for(I>N&&(N=I),M=1,A=1;i>=A;A++)if(M<<=1,M-=U[A],0>M)return-1;if(M>0&&(e===a||1!==j))return-1;for(V[1]=0,A=1;i>A;A++)V[A+1]=V[A]+U[A];for(P=0;p>P;P++)0!==t[d+P]&&(v[V[t[d+P]]++]=P);if(e===a?(q=F=v,S=19):e===s?(q=u,z-=257,F=l,H-=257,S=256):(q=f,F=h,S=-1),L=0,P=0,A=I,x=g,B=N,D=0,_=-1,R=1<<N,k=R-1,e===s&&R>r||e===c&&R>o)return 1;for(var J=0;;){J++,T=A-D,v[P]<S?(C=0,E=v[P]):v[P]>S?(C=F[H+v[P]],E=q[z+v[P]]):(C=96,E=0),b=1<<A-D,w=1<<B,I=w;do w-=b,m[x+(L>>D)+w]=T<<24|C<<16|E|0;while(0!==w);for(b=1<<A-1;L&b;)b>>=1;if(0!==b?(L&=b-1,L+=b):L=0,P++,0===--U[A]){if(A===j)break;A=t[d+v[P]]}if(A>N&&(L&k)!==_){for(0===D&&(D=N),x+=I,B=A-D,M=1<<B;j>B+D&&(M-=U[B+D],!(0>=M));)B++,M<<=1;if(R+=1<<B,e===s&&R>r||e===c&&R>o)return 1;_=L&k,m[_]=N<<24|B<<16|x-g|0}}return 0!==L&&(m[x+L]=A-D<<24|64<<16|0),y.bits=N,0}},{"../utils/common":4}],14:[function(e,t){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],15:[function(e,t,n){"use strict";function i(e){for(var t=e.length;--t>=0;)e[t]=0}function r(e){return 256>e?at[e]:at[256+(e>>>7)]}function o(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function a(e,t,n){e.bi_valid>W-n?(e.bi_buf|=t<<e.bi_valid&65535,o(e,e.bi_buf),e.bi_buf=t>>W-e.bi_valid,e.bi_valid+=n-W):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function s(e,t,n){a(e,n[2*t],n[2*t+1])}function c(e,t){var n=0;do n|=1&e,e>>>=1,n<<=1;while(--t>0);return n>>>1}function u(e){16===e.bi_valid?(o(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function l(e,t){var n,i,r,o,a,s,c=t.dyn_tree,u=t.max_code,l=t.stat_desc.static_tree,f=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;X>=o;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;J>n;n++)i=e.heap[n],o=c[2*c[2*i+1]+1]+1,o>p&&(o=p,m++),c[2*i+1]=o,i>u||(e.bl_count[o]++,a=0,i>=d&&(a=h[i-d]),s=c[2*i],e.opt_len+=s*(o+a),f&&(e.static_len+=s*(l[2*i+1]+a)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(i=e.bl_count[o];0!==i;)r=e.heap[--n],r>u||(c[2*r+1]!==o&&(e.opt_len+=(o-c[2*r+1])*c[2*r],c[2*r+1]=o),i--)}}function f(e,t,n){var i,r,o=new Array(X+1),a=0;for(i=1;X>=i;i++)o[i]=a=a+n[i-1]<<1;for(r=0;t>=r;r++){var s=e[2*r+1];0!==s&&(e[2*r]=c(o[s]++,s))}}function h(){var e,t,n,i,r,o=new Array(X+1);for(n=0,i=0;z-1>i;i++)for(ct[i]=n,e=0;e<1<<Q[i];e++)st[n++]=i;for(st[n-1]=i,r=0,i=0;16>i;i++)for(ut[i]=r,e=0;e<1<<et[i];e++)at[r++]=i;for(r>>=7;F>i;i++)for(ut[i]=r<<7,e=0;e<1<<et[i]-7;e++)at[256+r++]=i;for(t=0;X>=t;t++)o[t]=0;for(e=0;143>=e;)rt[2*e+1]=8,e++,o[8]++;for(;255>=e;)rt[2*e+1]=9,e++,o[9]++;for(;279>=e;)rt[2*e+1]=7,e++,o[7]++;for(;287>=e;)rt[2*e+1]=8,e++,o[8]++;for(f(rt,V+1,o),e=0;F>e;e++)ot[2*e+1]=5,ot[2*e]=c(e,5);lt=new dt(rt,Q,U+1,V,X),ft=new dt(ot,et,0,F,X),ht=new dt(new Array(0),tt,0,H,Z)}function d(e){var t;for(t=0;V>t;t++)e.dyn_ltree[2*t]=0;for(t=0;F>t;t++)e.dyn_dtree[2*t]=0;for(t=0;H>t;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*K]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function p(e){e.bi_valid>8?o(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function m(e,t,n,i){p(e),i&&(o(e,n),o(e,~n)),P.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function g(e,t,n,i){var r=2*t,o=2*n;return e[r]<e[o]||e[r]===e[o]&&i[t]<=i[n]}function v(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&g(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!g(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function y(e,t,n){var i,o,c,u,l=0;if(0!==e.last_lit)do i=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],o=e.pending_buf[e.l_buf+l],l++,0===i?s(e,o,t):(c=st[o],s(e,c+U+1,t),u=Q[c],0!==u&&(o-=ct[c],a(e,o,u)),i--,c=r(i),s(e,c,n),u=et[c],0!==u&&(i-=ut[c],a(e,i,u)));while(l<e.last_lit);s(e,K,t)}function b(e,t){var n,i,r,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=J,n=0;c>n;n++)0!==o[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):o[2*n+1]=0;for(;e.heap_len<2;)r=e.heap[++e.heap_len]=2>u?++u:0,o[2*r]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=a[2*r+1]);for(t.max_code=u,n=e.heap_len>>1;n>=1;n--)v(e,o,n);r=c;do n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],v(e,o,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,o[2*r]=o[2*n]+o[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,o[2*n+1]=o[2*i+1]=r,e.heap[1]=r++,v(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],l(e,t),f(o,u,e.bl_count)}function w(e,t,n){var i,r,o=-1,a=t[1],s=0,c=7,u=4;for(0===a&&(c=138,u=3),t[2*(n+1)+1]=65535,i=0;n>=i;i++)r=a,a=t[2*(i+1)+1],++s<c&&r===a||(u>s?e.bl_tree[2*r]+=s:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[2*G]++):10>=s?e.bl_tree[2*Y]++:e.bl_tree[2*$]++,s=0,o=r,0===a?(c=138,u=3):r===a?(c=6,u=3):(c=7,u=4))}function _(e,t,n){var i,r,o=-1,c=t[1],u=0,l=7,f=4;for(0===c&&(l=138,f=3),i=0;n>=i;i++)if(r=c,c=t[2*(i+1)+1],!(++u<l&&r===c)){if(f>u){do s(e,r,e.bl_tree);while(0!==--u)}else 0!==r?(r!==o&&(s(e,r,e.bl_tree),u--),s(e,G,e.bl_tree),a(e,u-3,2)):10>=u?(s(e,Y,e.bl_tree),a(e,u-3,3)):(s(e,$,e.bl_tree),a(e,u-11,7));u=0,o=r,0===c?(l=138,f=3):r===c?(l=6,f=3):(l=7,f=4)}}function k(e){var t;for(w(e,e.dyn_ltree,e.l_desc.max_code),w(e,e.dyn_dtree,e.d_desc.max_code),b(e,e.bl_desc),t=H-1;t>=3&&0===e.bl_tree[2*nt[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function x(e,t,n,i){var r;for(a(e,t-257,5),a(e,n-1,5),a(e,i-4,4),r=0;i>r;r++)a(e,e.bl_tree[2*nt[r]+1],3);_(e,e.dyn_ltree,t-1),_(e,e.dyn_dtree,n-1)}function S(e){var t,n=4093624447;for(t=0;31>=t;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return j;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return N;for(t=32;U>t;t++)if(0!==e.dyn_ltree[2*t])return N;return j}function T(e){mt||(h(),mt=!0),e.l_desc=new pt(e.dyn_ltree,lt),e.d_desc=new pt(e.dyn_dtree,ft),e.bl_desc=new pt(e.bl_tree,ht),e.bi_buf=0,e.bi_valid=0,d(e)}function C(e,t,n,i){a(e,(D<<1)+(i?1:0),3),m(e,t,n,!0)}function E(e){a(e,M<<1,3),s(e,K,rt),u(e)}function O(e,t,n,i){var r,o,s=0;e.level>0?(e.strm.data_type===B&&(e.strm.data_type=S(e)),b(e,e.l_desc),b(e,e.d_desc),s=k(e),r=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,r>=o&&(r=o)):r=o=n+5,r>=n+4&&-1!==t?C(e,t,n,i):e.strategy===I||o===r?(a(e,(M<<1)+(i?1:0),3),y(e,rt,ot)):(a(e,(R<<1)+(i?1:0),3),x(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),y(e,e.dyn_ltree,e.dyn_dtree)),d(e),i&&p(e)}function A(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(st[n]+U+1)]++,e.dyn_dtree[2*r(t)]++),e.last_lit===e.lit_bufsize-1}var P=e("../utils/common"),I=4,j=0,N=1,B=2,D=0,M=1,R=2,L=3,q=258,z=29,U=256,V=U+1+z,F=30,H=19,J=2*V+1,X=15,W=16,Z=7,K=256,G=16,Y=17,$=18,Q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],et=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],tt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],nt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],it=512,rt=new Array(2*(V+2));i(rt);var ot=new Array(2*F);i(ot);var at=new Array(it);i(at);var st=new Array(q-L+1);i(st);var ct=new Array(z);i(ct);var ut=new Array(F);i(ut);var lt,ft,ht,dt=function(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length},pt=function(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t},mt=!1;n._tr_init=T,n._tr_stored_block=C,n._tr_flush_block=O,n._tr_tally=A,n._tr_align=E},{"../utils/common":4}],16:[function(e,t){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=n},{}]},{},[1])(1)}),function(e,t){"function"==typeof define&&define.amd?define([],t):e.MT=t()}(this,function(){var requirejs,require,define;return function(e){function t(e,t){return v.call(e,t)}function n(e,t){var n,i,r,o,a,s,c,u,l,f,h,d=t&&t.split("/"),p=m.map,g=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(d=d.slice(0,d.length-1),e=e.split("/"),a=e.length-1,m.nodeIdCompat&&b.test(e[a])&&(e[a]=e[a].replace(b,"")),e=d.concat(e),l=0;l<e.length;l+=1)if(h=e[l],"."===h)e.splice(l,1),l-=1;else if(".."===h){if(1===l&&(".."===e[2]||".."===e[0]))break;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||g)&&p){for(n=e.split("/"),l=n.length;l>0;l-=1){if(i=n.slice(0,l).join("/"),d)for(f=d.length;f>0;f-=1)if(r=p[d.slice(0,f).join("/")],r&&(r=r[i])){o=r,s=l;break}if(o)break;!c&&g&&g[i]&&(c=g[i],u=l)}!o&&c&&(o=c,s=u),o&&(n.splice(0,s,o),e=n.join("/"))}return e}function i(t,n){return function(){var i=y.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),l.apply(e,i.concat([t,n]))}}function r(e){return function(t){return n(t,e)}}function o(e){return function(t){d[e]=t}}function a(n){if(t(p,n)){var i=p[n];delete p[n],g[n]=!0,u.apply(e,i)}if(!t(d,n)&&!t(g,n))throw new Error("No "+n);return d[n]}function s(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return function(){return m&&m.config&&m.config[e]||{}}}var u,l,f,h,d={},p={},m={},g={},v=Object.prototype.hasOwnProperty,y=[].slice,b=/\.js$/;f=function(e,t){var i,o=s(e),c=o[0];return e=o[1],c&&(c=n(c,t),i=a(c)),c?e=i&&i.normalize?i.normalize(e,r(t)):n(e,t):(e=n(e,t),o=s(e),c=o[0],e=o[1],c&&(i=a(c))),{f:c?c+"!"+e:e,n:e,pr:c,p:i}},h={require:function(e){return i(e)},exports:function(e){var t=d[e];return"undefined"!=typeof t?t:d[e]={}},module:function(e){return{id:e,uri:"",exports:d[e],config:c(e)}}},u=function(n,r,s,c){var u,l,m,v,y,b,w=[],_=typeof s;if(c=c||n,"undefined"===_||"function"===_){for(r=!r.length&&s.length?["require","exports","module"]:r,y=0;y<r.length;y+=1)if(v=f(r[y],c),l=v.f,"require"===l)w[y]=h.require(n);else if("exports"===l)w[y]=h.exports(n),b=!0;else if("module"===l)u=w[y]=h.module(n);else if(t(d,l)||t(p,l)||t(g,l))w[y]=a(l);else{if(!v.p)throw new Error(n+" missing "+l);v.p.load(v.n,i(c,!0),o(l),{}),w[y]=d[l]}m=s?s.apply(d[n],w):void 0,n&&(u&&u.exports!==e&&u.exports!==d[n]?d[n]=u.exports:m===e&&b||(d[n]=m))}else n&&(d[n]=s)},requirejs=require=l=function(t,n,i,r,o){if("string"==typeof t)return h[t]?h[t](n):a(f(t,n).f);if(!t.splice){if(m=t,m.deps&&l(m.deps,m.callback),!n)return;n.splice?(t=n,n=i,i=null):t=e}return n=n||function(){},"function"==typeof i&&(i=r,r=o),r?u(e,t,n,i):setTimeout(function(){u(e,t,n,i)},4),l},l.config=function(e){return l(e)},requirejs._defined=d,define=function(e,n,i){n.splice||(i=n,n=[]),t(d,e)||t(p,e)||(p[e]=[e,n,i])},define.amd={jQuery:!0}}(),define("almond",function(){}),define("socketio",["require"],function(){var e=window.io;return"undefined"==typeof e?(alert("socket.io 未引入"),!1):e}),define("utils/tools",["require"],function(require){var tools={getTime:function(){var e=new Date,t=function(e){var t=2;e=new String(e);for(var n=0,i="";n<t-e.length;n++)i+="0";return i+e};return t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+"."+t(e.getMilliseconds())},second2HMS:function(e){function t(e){return val=e>0?e>=10?e:"0"+e:"00"}e=parseInt(e);var n=Math.floor(e/3600),i=Math.floor(e%3600/60),r=Math.floor(e%3600%60),o=t(n),a=t(i),s=t(r),c=o+":"+a+":"+s;return c},debug:function(){if("undefined"!=typeof console)for(var e=0;e<arguments.length;e++)console.log(this.isIE()?"string"==typeof arguments[e]?arguments[e]:JSON.stringify(arguments[e]):arguments[e])},getFlash:function(e){if(-1==navigator.appName.indexOf("Microsoft"))return document[e];try{return document[e]}catch(t){return window[e]}},flashChecker:function(){var e=!1,t={},n=-1;if(document.all){try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(r){}i&&(e=!0,t=i.GetVariable("$version"),n=parseInt(t.split(" ")[1].split(",")[0]))}else if(navigator.plugins&&navigator.plugins.length>0){var i=navigator.plugins["Shockwave Flash"];if(i){e=!0;for(var o=i.description.split(" "),a=0;a<o.length;++a)isNaN(parseInt(o[a]))||(n=parseInt(o[a]))}}return{flash:e,version:n}},in_array:function(e,t){for(var n=0;n<t.length;n++)if(e==t[n])return!0;return!1},without:function(e,t){for(var n=e.length,i=0;n>i;i++)e[i]===t&&e.splice(i,1);return e},isIE:function(){var e=navigator.userAgent.toLowerCase(),t=!1;return(e.indexOf("msie")>-1||e.indexOf(".net")>-1)&&(t=!0),t},platform:function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("macintosh")>-1?"MacOS":e.indexOf("iphone")>-1||e.indexOf("ipad")>-1||e.indexOf("ios-sdk")>-1?"IOS":e.indexOf("android")>-1||e.indexOf("android-sdk")>-1?"Android":e.indexOf("linux")>-1?"Linux":e.indexOf("windows")>-1?"Windows":"Unknow"},isMobile:function(){var e=this.platform();return"Android"===e||"IOS"===e?!0:!1},isMobileSDK:function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("ios-sdk")>-1||e.indexOf("android-sdk")>-1?!0:!1},isWechat:function(){return navigator.userAgent.indexOf("MicroMessenger")>-1?!0:!1},userAgent:function(e){var t=navigator.userAgent.toLowerCase();return e=e.toLowerCase(),t.indexOf(e)>-1?!0:!1},isIphone:function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("iphone")>-1?!0:!1},isIpad:function(){},isAndroid:function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("android")>-1?!0:!1},insertPosition:function(e,t){var n=e,i=n,r=t;if(i.focus(),document.selection)i.focus(),sel=document.selection.createRange(),sel.text=r,sel.select();else if(i.selectionStart||"0"==i.selectionStart){var o=i.selectionStart,a=i.selectionEnd,s=i.scrollTop;i.value=i.value.substring(0,o)+r+i.value.substring(a,i.value.length),s>0&&(i.scrollTop=s),i.focus(),i.selectionStart=o+r.length,i.selectionEnd=o+r.length}else i.value+=r,i.focus()},ubb2img:function(e,t){var n=/\[.+?\]/g,i="",r=e,o=t;return o=o.replace(n,function(e){return i="undefined"!=typeof r[e]?'<img src="'+r[e]+'"/>':t})},formatTime:function(e){var t=parseInt(e/60);return 0===t&&(t=1),t},callback:function(e,t){"function"==typeof e&&e(t)},bindEvent:function(e,t,n){var i=this,r=arguments.length;if(3===r)if("undefined"!=typeof window.addEventListener)for(var o=e||arguments[0],t=t||arguments[1],a=n||arguments[2],s=0;s<a.length;s++)for(var c in a[s]){var u=t[a[s][c][1]],l=a[s][c][0];"click"===c&&(c=i.isMobile()?"touchstart":"click"),o.on(c,l,u)}else i.debug("事件绑定参数出错.")},now:function(){return(new Date).getTime()/1e3},ajax:function(conf){var type=conf.type,url=conf.url,data=conf.data,dataType=conf.dataType,success=conf.success;null==type&&(type="get"),null==dataType&&(dataType="text");var createAjax=function(){var e=null;try{e=new ActiveXObject("microsoft.xmlhttp")}catch(t){try{e=new XMLHttpRequest}catch(n){window.alert("您的浏览器不支持ajax，请更换！")}}return e},xhr=createAjax();xhr.open(type,url+"?"+data,!0),"GET"==type||"get"==type?xhr.send(null):("POST"==type||"post"==type)&&(xhr.setRequestHeader("content-type","application/x-www-form-urlencoded"),xhr.send(data)),xhr.onreadystatechange=function(){4==xhr.readyState&&200==xhr.status&&("text"==dataType||"TEXT"==dataType?null!=success&&success(xhr.responseText):"xml"==dataType||"XML"==dataType?null!=success&&success(xhr.responseXML):"json"==dataType||"JSON"==dataType?null!=success&&success(eval("("+xhr.responseText+")")):("jsonp"==dataType||"JSONP"==dataType)&&null!=success&&success(eval("("+xhr.responseText+")")))}}};return tools}),define("utils/map",["require"],function(){var e=function(){this.keys=new Array,this.data=new Object,this.put=function(e,t){null==this.data[e]&&this.keys.push(e),this.data[e]=t},this.get=function(e){return"undefined"==typeof this.data[e]?(this.data[e]=function(){},this.data[e]):this.data[e]},this.remove=function(e){this.keys.remove(e),this.data[e]=null},this.each=function(e){if(alert(e),"function"==typeof e)for(var t=this.keys.length,n=0;t>n;n++){var i=this.keys[n];e(i,this.data[i],n)}},this.entrys=function(){for(var e=this.keys.length,t=new Array(e),n=0;e>n;n++)t[n]={key:this.keys[n],value:this.data[n]};return t},this.isEmpty=function(){return 0==this.keys.length},this.size=function(){return this.keys.length},this.toString=function(){for(var e="{",t=0;t<this.keys.length;t++,e+=","){var n=this.keys[t];e+=n+"="+this.data[n]}return e+="}"}};return new e}),define("core/member",["require","../utils/tools","../utils/map"],function(e){var t=e("../utils/tools"),n=e("../utils/map"),i={userList:new Object,onlineXids:new Array,onlineUsers:function(e,n){t.debug("member.js => online list.");var i=this,r=i.userList,o=i.onlineXids,a=e.online.spadmin.data,s=e.online.admin.data,c=e.online.user.data,u=e.online.guest.data,l=[],f=[],h=[],d=[];for(var p in a)a[p].self=!1,a[p].xid===n?(a[p].self=!0,l.unshift(a[p])):l.push(a[p]);for(var m in s)s[m].self=!1,s[m].xid===n?(s[m].self=!0,f.unshift(s[m])):f.push(s[m]);for(var g in c)c[g].self=!1,c[g].xid===n?(c[g].self=!0,h.unshift(c[g])):h.push(c[g]);for(var v in u)u[v].self=!1,u[v].xid===n?(u[v].self=!0,d.unshift(u[v])):d.push(u[v]);for(var y=f.concat(l,h,d),b=0;b<y.length;b++){var w=y[b].xid.toString(),_=y[b];r[w]=_,o.push(w)}this.renderMember(y),this.countdown(e.online.total),window.__onlineXids=o,window.__userList=this.userList},renderMember:function(e){n.get("member:list")(e)},renderMemberPower:function(e,t){n.get("member:voice:power")(e,t)},addMember:function(e){var t=e.member,n=this.get(t.xid);n||(this.onlineXids.push(t.xid.toString()),this.userList[t.xid]=t,this.countdown(e.total))},deleteMember:function(e){var t=e,n=this.get(t.xid);if(n){try{delete this.userList[t.xid]}catch(i){this.userList[t.xid]="undefined"}for(var r=0;r<this.onlineXids.length;r++)t.xid==this.onlineXids[r]&&this.onlineXids.splice(r,1)}this.countdown(t.total)},get:function(e){return e?this.userList[e]:void 0},modeVoiceProwers:function(e){var t=e.xids,n=e.mode,i=this.onlineXids,r=this.onlineXids.length,o=this.userList;if(0==n){for(var a=0;r>a;a++){var s=o[i[a]].xid;this.userList[s].voice.enable=1,this.renderMemberPower(s,1)}this.VoicePowerSetting(t,0)}else{for(var a=0;r>a;a++){var s=o[i[a]].xid;this.userList[s].voice.enable=0,this.renderMemberPower(s,0)}this.VoicePowerSetting(t,1)}},modifyOneVoicePrower:function(e,t){var n=typeof this.userList[e];"undefined"!==n&&(this.userList[e].voice=t,this.renderMemberPower(e,t.enable))},VoicePowerSetting:function(e,t){for(var n=0,i=e.length;i>n;n++)this.userList[e[n]].voice.enable=t,this.renderMemberPower(e[n],t)},countdown:function(e){n.get("member:total")(e)}};return i}),define("jquery",["require"],function(){var e=window.jQuery||window.Zepto;return"undefined"==typeof e?(alert("请加载 jQuery/Zepto 库"),!1):e}),define("core/log",["require","jquery"],function(e){var t=e("jquery"),n="http://log.rye-tech.com",i={socket:function(e){t.ajax({type:"GET",url:n+"/stats/socket.html",data:e})},play:function(e){t.ajax({type:"GET",url:n+"/stats/play.html",data:e})}};return i}),define("mtvoice",["require","jquery"],function(e){var t=e("jquery"),n={};return n.version=1010,n.isStartUp=!1,n.config={debug:!0,host:"http://127.0.0.1",posts:["8500","8500","8500","8501","8502"],post:"8500"},n.ajax=function(e,i,r){e=JSON.stringify(e),e=encodeURIComponent(e),t.ajax({url:n.config.host+":"+n.config.post+"/maituo?json="+e,dataType:"jsonp",timeout:1e3,success:i||function(){},error:r||function(){}})},n.tool={debug:function(e){"undefined"!=typeof console&&n.config.debug&&console.debug(e)}},n.log=function(e){"undefined"!=typeof console&&n.config.debug&&(e=JSON.stringify(e),console.log(e))},n.check={status:!1,isChecked:!1,isPlugin:function(e){var t=function(){n.check.isChecked?e(n.check.checkVoice?!0:!1):setTimeout(function(){t()},100)};t()},reCheckPlugins:function(){var e=n.config.posts[0],i=(n.config.posts,{act:"MC_GET_VERSION"}),r={},o=0,a=null;i=JSON.stringify(i),i=encodeURIComponent(i),r=function(){return o>500?(clearInterval(a),!1):void t.ajax({url:n.config.host+":"+e+"/maituo?json="+i,dataType:"jsonp",timeout:3500,success:function(e){0===e.code&&window.location.reload()},error:function(e){n.log(e)}})},a=setInterval(function(){r()},1e3)},checkVoice:function(e){var i=function(e,i,r,o){i=JSON.stringify(i),i=encodeURIComponent(i),t.ajax({url:n.config.host+":"+e+"/maituo?json="+i,dataType:"jsonp",timeout:500,success:r||function(){},error:o||function(){}})},r=0,o=function(){var t=e[r];i(t,{act:"MC_GET_VERSION"},function(e){n.log("VOICE PLUGINS CONNECTINO_SUCCESS",e),0===e.code&&(n.config.post=t,n.check.checkVoice=e.value>=n.version?!0:!1,n.check.isChecked=!0)},function(){r++,r+1>e.length?(n.check.checkVoice=!1,n.check.isChecked=!0):o()})};o()}(n.config.posts),hasInit:!1,init:function(e,t){if(e){var i=function(){n.ajax({act:"CONNECTION_STATUS"},function(e){0==e.code&&3==e.value?(n.log("CONNECTION_STATUS success!"),n.check.status=!0,n.check.hasInit=!0,t()):setTimeout(function(){i()},500)})};n.ajax({act:"CONNECTION_OPEN",url:e,location:window.location.href},function(t){0==t.code?(n.log("CONNECTION_OPEN success!"),n.ajax({act:"CONNECTION_CAPTURE",value:0},function(e){0==e.code&&(n.log("CONNECTION_CAPTURE success!"),i())})):(n.log("Voice init false.  This is for Test."),alert("连接服务器失败,错误码："+t.code+", url:"+e))},function(){try{n.log("Voice init false.  This is for Test."),alert("连接服务器失败,错误码："+ret.code+", url:"+e)}catch(t){n.log(t)}})}}},n.op={getInputVolume:function(e){1==n.check.status&&n.ajax({act:"GET_INPUT_VOLUME"},function(i){n.log(i),0==i.code?(t("#debug").prepend("<p>getInputVolume: "+i.value+"</p>"),e(i.value)):e(0)})},setInputVolume:function(e,t){if(1==n.check.status){var i=parseInt(e,10);if(0/0===i)return!1;0>i?i=0:i>100&&(i=100),n.ajax({act:"SET_INPUT_VOLUME",value:i},function(e){n.log(e),t(0==e.code?i:0)})}},getOutVolume:function(e){1==n.check.status&&n.ajax({act:"GET_OUTPUT_VOLUME"},function(i){n.log(i),0==i.code?(t("#debug").prepend("<p>getOutVolume: "+i.value+"</p>"),e(i.value)):e(0)})},setOutVolume:function(e,t){if(1==n.check.status){var i=parseInt(e,10);if(0/0===i)return!1;0>i?i=0:i>100&&(i=100),n.ajax({act:"SET_OUTPUT_VOLUME",value:i},function(e){n.log(e),t(0==e.code?i:0)})}},setConfig:function(){1==n.check.status&&n.ajax({act:"MC_OPEN_SETTING"})},getPower:function(e){1==n.check.status&&n.ajax({act:"CONNECTION_GET_POWER"},function(t){e(0==t.code?t.value:0)})},getSpeaking:function(e){1==n.check.status&&n.ajax({act:"CONNECTION_GET_SPEAKING"},function(t){e(0==t.code?t.value:0)})},getPowerSpeaking:function(e){1==n.check.status&&n.ajax({act:"CONNECTION_GET_POWER_SPEAKING"},function(t){0==t.code&&e(t.power,t.value)})},setCapture:function(e,t){1==n.check.status&&n.ajax({act:"CONNECTION_CAPTURE",value:e},function(e){0==e.code&&"undefined"!=typeof t&&t(!0)})},playSysSound:function(e,i){{var r=e?1:0;n.op}1==n.check.status&&n.ajax({act:"SET_MIX_HARD",value:r},function(o){n.log(o),0==o.code?(t("#debug").prepend("<p>mix_hard: "+r+"</p>"),n.ajax({act:"QUALITY_SET",value:e?"sing_high2":"normal"}),i(!0)):i(!1)
})},setIgnore:function(e,i,r){e=parseInt(e,10),1==n.check.status&&n.ajax({act:"IGNORE_XID_VOICE",xid:e,value:i},function(o){n.log(o),0==o.code?(t("#debug").prepend("<p>setIgnore --> xid: "+e+", isIgnore: "+i+"</p>"),r(!0)):r(!1)})},checkStatus:function(e,t){e=parseInt(e,10),n.ajax({act:"CONNECTION_STATUS",xid:e},function(e){t(0==e.code?"undefined"!=typeof e.heartbeat&&1==e.heartbeat?!1:!0:!1)},function(){t(!1)})}},n}),define("core/mt.static",[],function(){var e={player:{},camera:{},CODE:{}};return e.CODE.SUCCESS=0,e.CODE.MEMBER_FORBIDDEN=10034,e.CODE_SUCCESS=0,e.EC_SUCCESS=0,e.EC_GENERAL_ERROR=-1,e.APP_HOST="http://open.rye-tech.com",e.STATIC_HOST="http://static-fast.rye-tech.com",e.MT_ADDMAPLIST_ERROR="绑定监听事件错误",e.SOCKET_CONNECT_NOTE="初始化未完成,请稍后重试",e.MT_CONNECTING="connecting",e.MT_CONNECT_SUCCESS="connect",e.MT_CONNECT_FAILED="connect_failed",e.MT_CONNECT_ERROR="error",e.MT_DISCONNECT="disconnect",e.MT_RECONNECTING="reconnecting",e.MT_RECONNECTING_FAILED="reconnecting_failed",e.PLAYER_CMD_START=1,e.PLAYER_CMD_PAUSE=2,e.PLAYER_CMD_STOP=3,e.PLAYER_CMD_RESUME=4,e.player.bufferlength=.5,e.player.bufferTimeMax=1,e.player.bufferTimeArr="[0.8,1.5,3]",e.player.cmdTimeDelay=0,e.camera.bufferlength=.5,e.camera.bufferTimeMax=1,e.camera.bufferTimeArr="[0.8,1.5,3]",e.VOICE_FLOW_DEFAULT=1,e.VOICE_FLOW_ADAPTER=2,e.VOICE_MODE_FREEDOM=0,e.VOICE_MODE_CHAIRMAN=1,e.VOICE_MODE_QUEUE=2,e.VOICE_MODE_HAND=3,e}),define("voice/model/voice.freedom",["require"],function(){}),define("voice/model/voice.chairman",["require"],function(){}),define("voice/model/voice.hand",["require","../../utils/map","../../utils/tools"],function(e){var t=e("../../utils/map"),n=e("../../utils/tools"),i={defaults:{allow:!1,modeType:3},handsList:[],inList:function(e){for(var t=this.handsList,n=!1,i=0;i<t.length;i++){if(t[i].xid==e){n=!0;break}n=!1}return n},addOne:function(e){var t=this.inList(e.xid);return t?!1:void this.handsList.push(e)},removeOne:function(e){var t=this.inList(e.xid);if(t)for(var n=(this.handsList,0);n<this.handsList.length;n++)this.handsList[n].xid==e.xid&&this.handsList.splice(n,1)},clear:function(e){if(e){var n={xids:e.voicePower,mode:this.defaults.modeType};this.Voice.modeVoiceProwers(n)}this.handsList.splice(0,this.handsList.length),t.get("voice:hand:reset")(this.handsList)},modifyPower:function(e,t){for(var n=this.handsList,i=0,r=n.length;r>i;i++)n[i].xid==e&&(this.handsList[i].voice.enable=t.enable)},handInit:function(){var e=this.MT;e.get("voice:hand:reset",this.handsList)},setIntoHandlist:function(e){var t=n.in_array(e,this.handsList);if(t)return!1;for(var i in e)this.handsList.push(e[i]);this.handInit(this.handsList)},eventAppoint:function(e,t){var n=(this.MT,i.operation);switch(e){case"voice:hand:up":n._join(t.args);break;case"voice:hand:leave":n._leave(t.args);break;case"voice:hand:allow":n._allow(t.args);break;case"voice:hand:forbid":n._forbid(t.args);break;case"voice:hand:remove":n._remove(t.args);break;case"voice:hand:clear":n._clear(t.args)}},init:function(e,t,n){this.handsList=[],this.MT=e,this.Voice=t,this.setIntoHandlist(n),i.operation.VoiceOperation=t.VoiceCloudOperation,i.operation.Voice=t,i.operation.Parent=this,window.__handsList=this.handsList}};return i.operation={_modify:function(e){var t=e.data,n=this.Parent;this.Voice.modifyUserVoicePrower(t.xid,t.voice),n.modifyPower(t.xid,t.voice)},_join:function(e){0===e.code&&i.addOne(e.data)},_leave:function(e){0===e.code&&(i.removeOne(e.data),this._modify(e))},_allow:function(e){0===e.code&&(this.VoiceOperation.VoiceEnable(),this._modify(e))},_forbid:function(e){0===e.code&&(this.VoiceOperation.VoiceDisable(),this._modify(e))},_remove:function(e){0===e.code&&(i.removeOne(e.data),this._modify(e))},_clear:function(e){0===e.code&&this.Parent.clear(e)}},i}),define("voice/model/voice.queue",["require","../../utils/map","../../utils/tools"],function(e){var t=e("../../utils/map"),n=(e("../../utils/tools"),{defaults:{modeType:2,micState:"close",currentQuser:{}},queueList:[],queueObj:{},inList:function(e){for(var t=this.queueList,n=!1,i=0;i<t.length;i++)if(t[i].xid){if(t[i].xid==e){n=!0;break}n=!1}return n},addOne:function(e){var t=this.inList(e.xid);return t?!1:(this.queueList.push(e),void(this.queueObj[e.xid]=e))},removeOne:function(e){var t=this.inList(e.xid);if(t){this.defaults.currentQuser.xid==e.xid&&this.stopCountdown();for(var n=0;n<this.queueList.length;n++)this.queueList[n].xid==e.xid&&(this.queueList.splice(n,1),delete this.queueObj[e.xid])}},addTime:function(e){var t=(e.xid,e.sec);this.curUserSecond=t},clear:function(e){if(e){var n={xids:e.voicePower,mode:this.defaults.modeType};this.Voice.modeVoiceProwers(n)}this.queueList.splice(0,this.queueList.length),this.queueObj={},this.stopCountdown(),t.get("voice:queue:reset")(this.queueList)},modifyPower:function(e,t){for(var n=this.queueList,i=0,r=n.length;r>i;i++)n[i].xid==e&&(n[i].voice.enable=t.enable)},queueInit:function(){var e=this.MT;e.get("voice:queue:reset",this.queueList),window.__queueList=this.queueList,window.__qobj=this.queueObj,window.__curQuser=this.defaults.currentQuser},initQueue:function(e){if(e.action){var t=e.action,n=e.data,i=this.sortVoiceQueue(n);if(this.queueList=i,this.queueInit(this.queueList),this.defaults.micState=n.memberState,"start"===t&&(this.queueList.length&&this.queueList.length>0?(this.defaults.currentQuser=this.queueObj[i[0].xid],this.startCountdown(i[0].xid)):this.curUserSecond=0),"pause"===t&&this.queueList.length>0){var r=this.queueList[0].xid;this.stopCountdown(r)}}},queueTimer:null,curUserSecond:0,countDown:function(e){var n=this,i=e;if(i&&i.sec>0){this.curUserSecond=i.sec;var r=function(){n.curUserSecond>0?n.queueTimer=setTimeout(function(){n.curUserSecond--,n.queueObj[i.xid].sec=n.curUserSecond,t.get("voice:queue:countdown")(n.curUserSecond),r()},1e3):(clearTimeout(n.queueTimer),t.get("voice:queue:countdown")(""))};r()}},stopCountdown:function(e){var n=this,i=0;clearTimeout(n.queueTimer),n.curUserSecond=0,i=e?this.queueObj[e].sec:"",t.get("voice:queue:countdown")(i)},startCountdown:function(e){var t=this.queueObj[e];t&&this.countDown(t)},sortVoiceQueue:function(e){var t=[];if("undefined"==typeof e.length)for(var n in e)if(this.addOne(e[n]),0==t.length)t.push(e[n]);else for(var i=0,r=t.length;r>i;i++){if(e[n].turn<t[i].turn){t.splice(i,0,e[n]);break}if("undefined"==typeof t[i+1]){t.push(e[n]);break}if(t[i+1].turn>e[n].turn){t.splice(i+1,0,e[n]);break}}else t=new Array;return t},eventAppoint:function(e,t){var i=(this.MT,n.operation);switch(e){case"voice:queue:list":i._qlist(t.args);break;case"voice:queue:join":i._join(t.args);break;case"voice:queue:leave":i._leave(t.args);break;case"voice:queue:move":i._move(t.args);break;case"voice:queue:moveto":i._move(t.args);break;case"voice:queue:time":i._addTime(t.args);break;case"voice:queue:remove":i._remove(t.args);break;case"voice:queue:control":i._control(t.args);break;case"voice:queue:clear":i._clear(t.args)}},init:function(e,t,n){this.queueList=[],this.MT=e,this.Voice=t,this.initQueue(n),this.operation.VoiceOperation=t.VoiceCloudOperation,this.operation.Voice=t,this.operation.Parent=this}});return n.operation={_modify:function(e){var t=e.data,n=this.Parent;this.Voice.modifyUserVoicePrower(t.xid,t.voice),n.modifyPower(t.xid,t.voice)},_qlist:function(e){var t=(e.action,e.data),n=this,t=(e.voicePower,{xids:e.voicePower,mode:n.Parent.defaults.modeType});n.Voice.modeVoiceProwers(t),n.Parent.initQueue(e)},_join:function(e){0===e.code&&n.addOne(e.data)},_leave:function(e){0===e.code&&(n.removeOne(e.data),this._modify(e))},_remove:function(e){0===e.code&&(n.removeOne(e.data),this._modify(e))},_addTime:function(e){this.Parent.addTime(e)},_control:function(e){var t=e.action,n=e.current,i=this.Parent;"pause"===t&&n&&(this.Voice.modifyUserVoicePrower(n.xid,n.voice),i.stopCountdown(n.xid))},_move:function(e){console.info(e)},_allow:function(e){0===e.code&&(this.VoiceOperation.VoiceEnable(),this._modify(e))},_forbid:function(e){0===e.code&&(this.VoiceOperation.VoiceDisable(),this._modify(e))},_clear:function(e){e&&this.Parent.clear(e)}},n}),define("voice/voice.control",["require","mtvoice","../core/mt.static","../utils/map","../core/member","../utils/tools","./model/voice.freedom","./model/voice.chairman","./model/voice.hand","./model/voice.queue"],function(e){var t=e("mtvoice"),n=e("../core/mt.static"),i=e("../utils/map"),r=e("../core/member"),o=e("../utils/tools"),a=(e("./model/voice.freedom"),e("./model/voice.chairman"),e("./model/voice.hand")),s=e("./model/voice.queue"),c={voiceMode:"rtmp",voiceModelType:-1,switchRoomType:function(e){switch(e=parseInt(e,10)){case 1:this.VoiceCloud.initVoiceCloud(this.room.conString,this.socket);break;case 2:this.VoiceRtmp.initRtmp();break;case 3:this.VoiceAutoModel.init(this.room.conString,this.socket)}},VoiceModel:function(e,t,n){{var r=this.MT;c.VoiceCloudOperation}switch(e=parseInt(e,10),this.voiceModelType=e,i.get("voice:model:init")(e,t),this.modeVoiceProwers(n),this.clearMode(),e){case 2:s.init(r,this,t);break;case 3:a.init(r,this,t)}},clearMode:function(){s.clear(),a.clear()},VoiceModelAppoint:function(e,t){var n=this.voiceModelType;2===n&&s.eventAppoint(e,t),3===n&&a.eventAppoint(e,t)},VoiceJudgement:function(){var e=o.platform().toLocaleUpperCase(),t=this.room;return"2"==t.voiceFlow?!0:"WINDOWS"!==e?!0:!1},setPlayer:function(e){this.player=e},modifyUserVoicePrower:function(e,t){e=parseInt(e,10),r.modifyOneVoicePrower(e,t)},VoicePowerSetting:function(e,t){r.VoicePowerSetting(e,t)},modeVoiceProwers:function(e){e&&r.modeVoiceProwers(e)},VoiceAllow:function(e,t){this.modifyUserVoicePrower(e,t)},VoiceForbid:function(e,t){this.modifyUserVoicePrower(e,t)},init:function(e,t,n){{var i=this;e.voiceFlow}i.MT=n,i.room=e,i.socket=t,i.switchRoomType(e.voiceFlow)}};return c.VoiceCloud={initVoiceCloud:function(e,r){var a=c.VoiceCloud;t.check.isPlugin(function(s){if(s)t.check.hasInit||t.check.init(e,function(){c.voiceMode="cloud",r.emit("voice:ready",function(e){o.debug("====== voiceReady ======"),e.code===n.CODE.SUCCESS&&(a.checkStatus(e.xid),a.listenPowerSpeaking())}),a.regOperation()});else{if(c.voiceMode="rtmp",c.VoiceJudgement())return void c.VoiceRtmp.initRtmp();i.get("mt:voice:unlaunch")(),a.reCheckVoice()}})},regOperation:function(){var e=c.MT,t=c.VoiceCloudOperation;e.on("mt:voice:connent:success",function(e){e("success")}),e.on("mt:voice:onshift",function(e){t.VoiceEnable(),e(1)}),e.on("mt:voice:unshift",function(e){t.VoiceDisable(),e(0)}),e.on("mt:voice:free",function(e){t.VoiceEnable(),e(1)}),e.on("mt:voice:close",function(e){t.VoiceDisable(),e(0)}),e.on("mt:voice:accompany:open",function(e){t.clickAccompany(),e(!0)}),e.on("mt:voice:accompany:stop",function(e){t.clickAccompanyStop(),e(!1)})},checkStatus:function(e){var n=this;if("undefined"==typeof n.checkStatusOpen){n.checkStatusOpen=!0,o.debug("voice checkStatus...");var r=0,a=function(){t.op.checkStatus(e,function(e){if(e)n.status=!0,r=0;else if(r+=1,r>=3)return n.status=!1,i.get("mt:voice:disconnent")(r),void n.reCheckVoice();setTimeout(function(){a()},5e3)})};a()}},reCheckVoice:function(){t.check.reCheckPlugins()},listenPowerSpeaking:function(){var e=this;if("undefined"==typeof e.listenPowerSpeakingOpen){e.listenPowerSpeakingOpen=!0,o.debug("voice listenPowerSpeaking...");var n=function(){var n=null;n=setTimeout(function(){e.status===!0&&t.op.getPowerSpeaking(function(t,n){i.get("mt:voice:power")(t),e.viewerSpeaking(n)}),setTimeout(arguments.callee,200);try{CollectGarbage()}catch(n){}},200)};n()}},viewerSpeaking:function(){}},c.VoiceCloudOperation={clickSpeakFree:function(){return t.op.setCapture(0,function(){}),!1},clickSpeakPress:function(){return t.op.setCapture(1,function(){}),!1},clickAccompany:function(){return t.op.playSysSound(!0,function(e){}),!1},clickAccompanyStop:function(){return t.op.playSysSound(!1,function(e){}),!1},VoiceEnable:function(){return t.op.setCapture(1,function(){}),!1},VoiceDisable:function(){return t.op.setCapture(0,function(){}),!1}},c.VoiceRtmp={rtmpPlaying:!1,initRtmp:function(){this.voiceRtmpPlay()},getPlayer:function(e){var t=c.player;return"function"==typeof e&&e(t),!1},voiceRtmpPlay:function(){var e=c,t=this;return o.isMobile()?!1:(e.voiceMode="rtmp",void this.getPlayer(function(n){var i=e.room.rtmp,r=null;if(!n)return!1;if(i){var a=function(){r=setTimeout(function(){o.debug("player audioPlay() start...");try{t.rtmpPlaying=n.audioPlay(i.video.server,i.video.path),o.debug("audioPlay() @===> "+t.rtmpPlaying),t.rtmpPlaying&&clearTimeout(r)}catch(e){a()}},300)};a()}}))},voiceRtmpStop:function(){this.getPlayer(function(e){o.debug("stop mic rtmp");var t=function(){try{e.audioStop()}catch(n){t()}};t()})}},c.VoiceAutoModel={init:function(e,i){if(o.isMobile())return!1;var r=c.VoiceCloud;t.check.isPlugin(function(a){a?t.check.hasInit||t.check.init(e,function(){c.voiceMode="cloud",i.emit("voice:ready",function(e){o.debug("====== voiceReady ======"),e.code===n.CODE.SUCCESS&&(r.checkStatus(e.xid),r.listenPowerSpeaking())}),r.regOperation()}):(c.voiceMode="cloud",c.VoiceRtmp.initRtmp())})}},c}),define("core/socket.init",["require","socketio","./member","./log","../utils/tools","../voice/voice.control","../utils/map"],function(e){var t=e("socketio"),n=e("./member"),i=e("./log"),r=e("../utils/tools"),o=e("../voice/voice.control"),a=e("../utils/map"),s={room:null,callback:null,obj:null,connectSuc:!1,trigger:function(e,t,n){switch(n.length){case 0:return void e.trigger(t,"");case 1:return void e.trigger(t,n[0]);case 2:return void e.trigger(t,n[0],n[1]);case 3:return void e.trigger(t,n[0],n[1],n[2]);default:e.trigger(t,n)}},emit:function(){var e={cmd:null,args:[]},t=null;e.cmd=arguments[0];for(var n=1;n<arguments.length;n++)"function"==typeof arguments[n]?t=arguments[n]:e.args.push(arguments[n]);this.obj&&(e=pako.deflate(JSON.stringify(e),{to:"string"}),this.obj.emit("income",e,function(e){"undefined"!=typeof e.code&&-5===e.code?window.location.reload():t&&t(e)}))},onBroadcast:function(e){if("object"==typeof e){var t={},n=this,i=n.room.curUser.xid,o=n.room.curUser.sid;if("undefined"!=typeof i&&!("undefined"!=typeof e.nosid&&e.nosid.length>0&&r.in_array(o,e.nosid)||"undefined"!=typeof e.noxid&&e.noxid.length>0&&r.in_array(i,e.noxid)))return r.debug("socket on: ======> "+e.cmd,e.args),t.cmd=e.cmd,t.args=e.args,t}},listenSystemCmd:function(e){var t=this,s=this.room.user,c=0;try{e.on("connect",function(){r.debug("服务器链接成功..."),e.socket_id=e.id,i.socket("uri="+e.io.uri+"&socket_id="+e.id+"&status=connect&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid);try{a.get("connect")()}catch(n){}t.connectSuc=!0}),e.on("connect_failed",function(t){r.debug("连接服务器失败,失败信息:"+t),i.socket("uri="+e.io.uri+"&socket_id="+e.id+"&status=connect_failed&reason="+t+"&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid),a.get("connect_failed")(t)}),e.on("connect_error",function(n){if(c++,c>3)try{e.close(),t.connect(t.room.websocket.shift(),t.callback)}catch(o){}r.debug("连接服务器错误,错误信息:"+n+",times:"+c),i.socket("uri="+e.io.uri+"&socket_id="+e.id+"&status=connect_error&reason="+n+"&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid),a.get("connect_error")(n)}),e.on("disconnect",function(t){i.socket("uri="+e.io.uri+"&socket_id="+e.socket_id+"&status=disconnect&reason="+t+"&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid),a.get("disconnect")(t)}),e.on("reconnect",function(t){i.socket("uri="+e.io.uri+"&socket_id="+e.id+"&status=reconnect&number="+t+"&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid),a.get("reconnect")(t)}),e.on("reconnect_attempt",function(){}),e.on("reconnecting",function(t){r.debug("正在重新连接:"+t),i.socket("uri="+e.io.uri+"&socket_id="+e.id+"&status=reconnecting&number="+t+"&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid),a.get("reconnecting")(t)}),e.on("reconnect_error",function(t){r.debug("重新连接失败!"),i.socket("uri="+e.io.uri+"&socket_id="+e.id+"&status=reconnect_error&reason="+t+"&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid),a.get("reconnect_error")(t)}),e.on("reconnect_failed",function(){r.debug("重新连接失败..."),i.socket("uri="+e.io.uri+"&socket_id="+e.id+"&status=reconnect_failed&xid="+s.xid+"&pid="+s.pid+"&roomid="+s.roomid),a.get("reconnect_failed")()}),e.on("member:join:me",function(e){r.debug("初始化数据完成 ====> member:join:me"),r.debug(e);var t=s.xid;n.onlineUsers(e,t),a.get("member:join:me")(e),o.voiceModelType=e.room.voice.mode,a.get("voice:model:init")(o.voiceModelType),e.voiceQueueList&&o.VoiceModel(e.room.voice.mode,e.voiceQueueList),e.hands&&o.VoiceModel(e.room.voice.mode,e.hands)})}catch(u){throw alert(u.message),new Error("系统事件:"+u.message)}},connect:function(e,n){if(!e)return!1;var i=this.room;this.obj=t.connect(e,{timeout:2e3,reconnection:!0,multiplex:!1,reconnectionDelay:1e3,reconnectionDelayMax:5e3,query:"access_token="+i.access_token+"&sessionid="+i.user.sessionid}),this.listenSystemCmd(this.obj),n(this.obj)},init:function(e,t){var n=e,i=this;return i.room=e,i.callback=t,n.websocket&&n.access_token?("string"==typeof i.room.websocket&&(i.room.websocket=[i.room.websocket]),void this.connect(i.room.websocket.shift(),t)):(alert("获取聊天服务器地址失败！"),!1)}};return s}),define("core/socket.maplist",["require","../utils/tools"],function(e){var t=e("../utils/tools"),n={mapCaselist:[],set:function(e,n){var i=t.in_array(e,this.mapCaselist);if(i)return!1;if("function"==typeof n){this.mapCaselist.push([e,n])}console.debug(this.mapCaselist)},get:function(e){var n=t.in_array(e,this.mapCaselist);return n?e:null}};return n}),define("swfobject",[],function(){var e=function(){function t(){if(!X&&document.getElementsByTagName("body")[0]){try{var e,t=y("span");t.style.display="none",e=q.getElementsByTagName("body")[0].appendChild(t),e.parentNode.removeChild(e),e=null,t=null}catch(n){return}X=!0;for(var i=V.length,r=0;i>r;r++)V[r]()}}function n(e){X?e():V[V.length]=e}function i(e){if(typeof L.addEventListener!=I)L.addEventListener("load",e,!1);else if(typeof q.addEventListener!=I)q.addEventListener("load",e,!1);else if(typeof L.attachEvent!=I)w(L,"onload",e);else if("function"==typeof L.onload){var t=L.onload;L.onload=function(){t(),e()}}else L.onload=e}function r(){var e=q.getElementsByTagName("body")[0],t=y(j);t.setAttribute("style","visibility: hidden;"),t.setAttribute("type",D);var n=e.appendChild(t);if(n){var i=0;!function r(){if(typeof n.GetVariable!=I)try{var a=n.GetVariable("$version");a&&(a=a.split(" ")[1].split(","),G.pv=[b(a[0]),b(a[1]),b(a[2])])}catch(s){G.pv=[8,0,0]}else if(10>i)return i++,void setTimeout(r,10);e.removeChild(t),n=null,o()}()}else o()}function o(){var e=F.length;if(e>0)for(var t=0;e>t;t++){var n=F[t].id,i=F[t].callbackFn,r={success:!1,id:n};if(G.pv[0]>0){var o=v(n);if(o)if(!_(F[t].swfVersion)||G.wk&&G.wk<312)if(F[t].expressInstall&&s()){var l={};l.data=F[t].expressInstall,l.width=o.getAttribute("width")||"0",l.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(l.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(l.align=o.getAttribute("align"));for(var f={},h=o.getElementsByTagName("param"),d=h.length,p=0;d>p;p++)"movie"!=h[p].getAttribute("name").toLowerCase()&&(f[h[p].getAttribute("name")]=h[p].getAttribute("value"));c(l,f,n,i)}else u(o),i&&i(r);else x(n,!0),i&&(r.success=!0,r.ref=a(n),r.id=n,i(r))}else if(x(n,!0),i){var m=a(n);m&&typeof m.SetVariable!=I&&(r.success=!0,r.ref=m,r.id=m.id),i(r)}}}function a(e){var t=null,n=v(e);return n&&"OBJECT"===n.nodeName.toUpperCase()&&(t=typeof n.SetVariable!==I?n:n.getElementsByTagName(j)[0]||n),t}function s(){return!W&&_("6.0.65")&&(G.win||G.mac)&&!(G.wk&&G.wk<312)}function c(e,t,n,i){var r=v(n);if(n=g(n),W=!0,E=i||null,O={success:!1,id:n},r){"OBJECT"==r.nodeName.toUpperCase()?(T=l(r),C=null):(T=r,C=n),e.id=M,(typeof e.width==I||!/%$/.test(e.width)&&b(e.width)<310)&&(e.width="310"),(typeof e.height==I||!/%$/.test(e.height)&&b(e.height)<137)&&(e.height="137");var o=G.ie?"ActiveX":"PlugIn",a="MMredirectURL="+encodeURIComponent(L.location.toString().replace(/&/g,"%26"))+"&MMplayerType="+o+"&MMdoctitle="+encodeURIComponent(q.title.slice(0,47)+" - Flash Player Installation");if(typeof t.flashvars!=I?t.flashvars+="&"+a:t.flashvars=a,G.ie&&4!=r.readyState){var s=y("div");n+="SWFObjectNew",s.setAttribute("id",n),r.parentNode.insertBefore(s,r),r.style.display="none",p(r)}h(e,t,n)}}function u(e){if(G.ie&&4!=e.readyState){e.style.display="none";var t=y("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(l(e),t),p(e)}else e.parentNode.replaceChild(l(e),e)}function l(e){var t=y("div");if(G.win&&G.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(j)[0];if(n){var i=n.childNodes;if(i)for(var r=i.length,o=0;r>o;o++)1==i[o].nodeType&&"PARAM"==i[o].nodeName||8==i[o].nodeType||t.appendChild(i[o].cloneNode(!0))}}return t}function f(e,t){var n=y("div");return n.innerHTML="<object classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'><param name='movie' value='"+e+"'>"+t+"</object>",n.firstChild}function h(e,t,n){var i,r=v(n);if(n=g(n),G.wk&&G.wk<312)return i;if(r){var o,a,s,c=y(G.ie?"div":j);typeof e.id==I&&(e.id=n);for(s in t)t.hasOwnProperty(s)&&"movie"!==s.toLowerCase()&&d(c,s,t[s]);G.ie&&(c=f(e.data,c.innerHTML));for(o in e)e.hasOwnProperty(o)&&(a=o.toLowerCase(),"styleclass"===a?c.setAttribute("class",e[o]):"classid"!==a&&"data"!==a&&c.setAttribute(o,e[o]));G.ie?H[H.length]=e.id:(c.setAttribute("type",D),c.setAttribute("data",e.data)),r.parentNode.replaceChild(c,r),i=c}return i}function d(e,t,n){var i=y("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function p(e){var t=v(e);t&&"OBJECT"==t.nodeName.toUpperCase()&&(G.ie?(t.style.display="none",function n(){if(4==t.readyState){for(var e in t)"function"==typeof t[e]&&(t[e]=null);t.parentNode.removeChild(t)}else setTimeout(n,10)}()):t.parentNode.removeChild(t))}function m(e){return e&&e.nodeType&&1===e.nodeType}function g(e){return m(e)?e.id:e}function v(e){if(m(e))return e;var t=null;try{t=q.getElementById(e)}catch(n){}return t}function y(e){return q.createElement(e)}function b(e){return parseInt(e,10)}function w(e,t,n){e.attachEvent(t,n),J[J.length]=[e,t,n]}function _(e){e+="";var t=G.pv,n=e.split(".");return n[0]=b(n[0]),n[1]=b(n[1])||0,n[2]=b(n[2])||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function k(e,t,n,i){var r=q.getElementsByTagName("head")[0];if(r){var o="string"==typeof n?n:"screen";if(i&&(A=null,P=null),!A||P!=o){var a=y("style");a.setAttribute("type","text/css"),a.setAttribute("media",o),A=r.appendChild(a),G.ie&&typeof q.styleSheets!=I&&q.styleSheets.length>0&&(A=q.styleSheets[q.styleSheets.length-1]),P=o}A&&(typeof A.addRule!=I?A.addRule(e,t):typeof q.createTextNode!=I&&A.appendChild(q.createTextNode(e+" {"+t+"}")))}}function x(e,t){if(Z){var n=t?"visible":"hidden",i=v(e);X&&i?i.style.visibility=n:"string"==typeof e&&k("#"+e,"visibility:"+n)}}function S(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=I?encodeURIComponent(e):e}{var T,C,E,O,A,P,I="undefined",j="object",N="Shockwave Flash",B="ShockwaveFlash.ShockwaveFlash",D="application/x-shockwave-flash",M="SWFObjectExprInst",R="onreadystatechange",L=window,q=document,z=navigator,U=!1,V=[],F=[],H=[],J=[],X=!1,W=!1,Z=!0,K=!1,G=function(){var e=typeof q.getElementById!=I&&typeof q.getElementsByTagName!=I&&typeof q.createElement!=I,t=z.userAgent.toLowerCase(),n=z.platform.toLowerCase(),i=/win/.test(n?n:t),r=/mac/.test(n?n:t),o=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a="Microsoft Internet Explorer"===z.appName,s=[0,0,0],c=null;if(typeof z.plugins!=I&&typeof z.plugins[N]==j)c=z.plugins[N].description,c&&typeof z.mimeTypes!=I&&z.mimeTypes[D]&&z.mimeTypes[D].enabledPlugin&&(U=!0,a=!1,c=c.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),s[0]=b(c.replace(/^(.*)\..*$/,"$1")),s[1]=b(c.replace(/^.*\.(.*)\s.*$/,"$1")),s[2]=/[a-zA-Z]/.test(c)?b(c.replace(/^.*[a-zA-Z]+(.*)$/,"$1")):0);else if(typeof L.ActiveXObject!=I)try{var u=new ActiveXObject(B);u&&(c=u.GetVariable("$version"),c&&(a=!0,c=c.split(" ")[1].split(","),s=[b(c[0]),b(c[1]),b(c[2])]))}catch(l){}return{w3:e,pv:s,wk:o,ie:a,win:i,mac:r}}();!function(){G.w3&&((typeof q.readyState!=I&&("complete"===q.readyState||"interactive"===q.readyState)||typeof q.readyState==I&&(q.getElementsByTagName("body")[0]||q.body))&&t(),X||(typeof q.addEventListener!=I&&q.addEventListener("DOMContentLoaded",t,!1),G.ie&&(q.attachEvent(R,function e(){"complete"==q.readyState&&(q.detachEvent(R,e),t())}),L==top&&!function n(){if(!X){try{q.documentElement.doScroll("left")}catch(e){return void setTimeout(n,0)}t()}}()),G.wk&&!function i(){return X?void 0:/loaded|complete/.test(q.readyState)?void t():void setTimeout(i,0)}()))}()}V[0]=function(){U?r():o()};!function(){G.ie&&window.attachEvent("onunload",function(){for(var t=J.length,n=0;t>n;n++)J[n][0].detachEvent(J[n][1],J[n][2]);for(var i=H.length,r=0;i>r;r++)p(H[r]);for(var o in G)G[o]=null;G=null;for(var a in e)e[a]=null;e=null})}();return{registerObject:function(e,t,n,i){if(G.w3&&e&&t){var r={};r.id=e,r.swfVersion=t,r.expressInstall=n,r.callbackFn=i,F[F.length]=r,x(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return G.w3?a(e):void 0},embedSWF:function(e,t,i,r,o,a,u,l,f,d){var p=g(t),m={success:!1,id:p};G.w3&&!(G.wk&&G.wk<312)&&e&&t&&i&&r&&o?(x(p,!1),n(function(){i+="",r+="";var n={};if(f&&typeof f===j)for(var g in f)n[g]=f[g];n.data=e,n.width=i,n.height=r;var v={};if(l&&typeof l===j)for(var y in l)v[y]=l[y];if(u&&typeof u===j)for(var b in u)if(u.hasOwnProperty(b)){var w=K?encodeURIComponent(b):b,k=K?encodeURIComponent(u[b]):u[b];typeof v.flashvars!=I?v.flashvars+="&"+w+"="+k:v.flashvars=w+"="+k}if(_(o)){var S=h(n,v,t);n.id==p&&x(p,!0),m.success=!0,m.ref=S,m.id=S.id}else{if(a&&s())return n.data=a,void c(n,v,t,d);x(p,!0)}d&&d(m)})):d&&d(m)},switchOffAutoHideShow:function(){Z=!1},enableUriEncoding:function(e){K=typeof e===I?!0:e},ua:G,getFlashPlayerVersion:function(){return{major:G.pv[0],minor:G.pv[1],release:G.pv[2]}},hasFlashPlayerVersion:_,createSWF:function(e,t,n){return G.w3?h(e,t,n):void 0},showExpressInstall:function(e,t,n,i){G.w3&&s()&&c(e,t,n,i)},removeSWF:function(e){G.w3&&p(e)},createCSS:function(e,t,n,i){G.w3&&k(e,t,n,i)},addDomLoadEvent:n,addLoadEvent:i,getQueryParamValue:function(e){var t=q.location.search||q.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return S(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return S(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(W){var e=v(M);e&&T&&(e.parentNode.replaceChild(T,e),C&&(x(C,!0),G.ie&&(T.style.display="block")),E&&E(O)),W=!1}},version:"2.3"}}();return e}),define("core/player",["require","../utils/tools","swfobject","./mt.static","../voice/voice.control","../utils/map"],function(e){var t=e("../utils/tools"),n=e("swfobject"),i=e("./mt.static"),r=e("../voice/voice.control"),o=e("../utils/map"),a={action:"wait",playerLoaded:!1,cameraPlayerLoaded:!1,voiceRtmp:!0,mainPlayerId:null,cameraPlayerId:null,room:null,getVoiceMode:function(){return r.voiceMode},initPlayer:function(e){if(!this.cameraPlayerLoaded||!this.playerLoaded)return!1;this.room=e,t.debug("player-init."),t.debug(e);var n=this,i=e.initData;this.getPlayer(function(e){"live"===i.mode?(t.debug("====initPlayer : live mode===="),o.get("live:"+i.action)()):(t.debug("====initPlayer : whiteboard mode==="),t.debug("live:===> "+MT.action),o.get("live:"+MT.action)(),i.step1&&e.command(i.step1),"start"==i.action?(MT.action="start",n.action="start",o.get("live:start")(),i.step2&&(e.command(i.step2),r.VoiceJudgement()&&r.VoiceRtmp.initRtmp()),i.step3&&e.command(i.step3),i.step4&&e.command(i.step4)):"wait"==i.action&&(n.action="wait",MT.action="wait","start"===MT.action?o.get("live:stop")():o.get("live:wait")()))})},controlPlayer:function(e){var n=this,i=(n.room,e.args.action),r=e.args.server,o=e.args.path;t.debug("=== controlPlayer : "+i+" ==="),n.getPlayer(function(e){"load"===i?e.load(r,o):"start"===i||"resume"===i?e.play(r,o):"pause"===i?e.pause():"stop"===i&&e.stop()})},whiteBoard:function(e){var n=e.args,i=this;if(t.debug("=== whiteBoard : "+e+" ==="),n.args&&n.args.t)if("start"===n.args.t){var a="",s=typeof n.title;"undefined"!==s&&(a=n.title),MT.action="start",i.action="start",o.get("live:start")(a),i.room.rtmp=n.rtmp,i.room.live=n.live,r.switchRoomType(i.room.voiceFlow)}else"stop"===n.args.t?("wait"===MT.action?(i.action="wait",o.get("live:wait")()):(i.action="stop",o.get("live:stop")()),MT.action="stop",r.VoiceRtmp.voiceRtmpStop()):"pause"===n.args.t&&(MT.action="pause",i.action="pause",o.get("live:pause")());this.getPlayer(function(e){e.command(n.metadata)})},setPlayer:function(e){var n=this,i=null,o=function(){n.playerLoaded===!1?i=setTimeout(function(){o()},200):(n.playerLoaded===!1&&t.getFlash(n.mainPlayerId),"function"==typeof e&&e(t.getFlash(n.mainPlayerId)),r.setPlayer(t.getFlash(n.mainPlayerId)))};o()},getPlayer:function(e){this.setPlayer(e)},setCameraPlayer:function(e){var n=this,i=null,r=function(){if(n.cameraPlayerLoaded===!1)i=setTimeout(function(){r()},200);else if(n.cameraPlayerLoaded===!1&&t.getFlash(n.cameraPlayerId),"function"==typeof e){var o=t.getFlash(n.cameraPlayerId);e(o)}};r()},getCameraPlayer:function(e){this.setCameraPlayer(e)},mainPlayer:function(e,r,o){var a=location.href.indexOf("debug=list")>0?"list":"",s="10.2.0",c="",u=this.room.swfUrl,l=this.room.curUser;if("function"!=typeof o&&(o=function(){}),"undefined"==typeof r)throw new Error("播放器ID 未定义");this.mainPlayerId=r;var f={bufferlength:i.player.bufferlength,bufferTimeMax:i.player.bufferTimeMax,bufferTimeArr:i.player.bufferTimeArr,cmdTimeDelay:i.player.cmdTimeDelay,xid:l.xid,uid:l.uid,pid:l.pid,roomid:l.roomid,debug:a};for(var h in this.room.flashvar)f[h]=this.room.flashvar[h];var d={};d.quality="high",d.bgcolor="#FFFFFF",d.allowscriptaccess="always",d.allowfullscreen="true",d.wmode="transparent";var p={};p.id=r,p.name=r,p.align="middle",t.debug("主播播放器渲染开始...");try{n.embedSWF(u,e,"100%","100%",s,c,f,d,p)}catch(m){}n.createCSS("#"+r,"display:block;"),t.debug("主播播放器渲染完成...")},camera:function(e,r,o){var a=this,s=location.href.indexOf("debug=list")>0?"list":"",c="10.2.0",u=a.room.cameraUrl;if(xiSwfUrlStr="",user=this.room.curUser,"function"!=typeof o&&(o=function(){}),"undefined"==typeof r)throw new Error("播放器ID 未定义");this.cameraPlayerId=r;var l={bufferlength:i.camera.bufferlength,bufferTimeMax:i.camera.bufferTimeMax,bufferTimeArr:i.player.bufferTimeArr,xid:user.xid,uid:user.uid,pid:user.pid,roomid:user.roomid,debug:s};for(var f in this.room.flashvar)l[f]=this.room.flashvar[f];var h={};h.quality="high",h.bgcolor="#ffffff",h.allowscriptaccess="always",h.allowfullscreen="true",h.wmode="transparent";var d={};d.id=r,d.name=r,d.align="middle";try{n.embedSWF(u,e,"100%","100%",c,xiSwfUrlStr,l,h,d)}catch(p){}n.createCSS("#"+r,"display:block;"),t.debug("摄像头渲染完成...")},cameraCallback:function(e){var n=null,i=this,r=function(){t.debug("camera-callback:"+i.cameraPlayerLoaded),i.cameraPlayerLoaded&&(clearInterval(n),o.get("cameraCallback")(e))};n=setInterval(function(){r()},400)},mainPlayerCallback:function(e){var t=null,n=this,i=function(){return n.playerLoaded?(clearInterval(t),e):void 0};t=setInterval(function(){i()},400)}};return a}),define("core/room.init",["require","jquery","utils/tools","utils/map","core/mt.static","./player"],function(e){var t=e("jquery"),n=e("utils/tools"),i=e("utils/map"),r=e("core/mt.static"),o=e("./player"),a={getAccessToken:function(){return this.access_token||window.access_token},init:function(e,o){n.debug("room.init.js => module init.");var a=this,s=e;a.access_token=s,t.ajax({type:"GET",url:r.APP_HOST+"/live/init.php",dataType:"jsonp",data:"access_token="+e,success:function(t){if(t.code===r.CODE.SUCCESS){var c=t;a.access_token=e,a.room=c,n.debug("房间验证成功====>",c),o(c),a.heartBeat(c,s,1)}else{if(t.code!==r.CODE.MEMBER_FORBIDDEN)return alert(t.msg),!1;i.get("member:forbidden")(t)}},error:function(){alert("链接超时,请重试...")}})},heartBeat:function(e,a,s){var c=1e3*e.heartbeatInterval,u=s,l=null,f=function(){t.ajax({type:"GET",url:r.APP_HOST+"/live/heartbeat.php",data:"v_type=1&onload="+u+"&access_token="+a,success:function(t){if(0===t.code&&t.data.InitData.action!==MT.action&&(e.initData=t.data.InitData,n.isMobile()||o.initPlayer(e),"wait"===t.data.InitData.action&&(i.get("live:stop")(),!n.isMobile())))try{n.getFlash(o.cameraPlayerId).cameraStop()
}catch(r){}}})};f(),l=setInterval(function(){f()},c),1===u&&(u=0)}};return a}),define("core/question",["require","jquery","../utils/map","./mt.static","../utils/tools"],function(e){var t=e("jquery"),n=(e("../utils/map"),e("./mt.static")),i=e("../utils/tools"),r={access_token:null,getList:function(e,r){this.access_token=e,i.debug("======> question list init");t.ajax({type:"GET",url:n.APP_HOST+"/live/questions.php",dataType:"jsonp",data:"access_token="+e,success:function(e){return e.code!==n.EC_SUCCESS?(alert("获取问答列表失败"),!1):(i.debug("获取问答列表成功..."),void r(e))},error:function(){alert("连接超时,请重试...")}})},quesPost:function(e,r,o){i.debug(e,r);var a=this,s=encodeURIComponent(r.content),c="",u=n.APP_HOST+"/live/interaction.php";switch(e){case"ask":c+="action="+r.action+"&content="+s;break;case"reply":c+="action="+r.action+"&replyId="+r.replyId+"&content="+s;break;case"delqus":c+="action="+r.action+"&qid="+r.qid}c=c+"&access_token="+this.access_token,t.ajax({type:"POST",url:u,dataType:"jsonp",data:c,success:function(e){var t=new Date,n=t.getTime(),i=e;if(a.lastPost=n,"undefined"!=typeof i&&null!==i){if(21==i.code)return o(i),!1;if(20==i.code)return a.lastQuestion=s,o(i),!1;o(i)}}})}};return r}),define("plugins/vote/vote",["require","../../utils/map","../../core/mt.static","../../utils/tools"],function(e){var t=(e("../../utils/map"),e("../../core/mt.static")),n=e("../../utils/tools"),i={voteUrl:t.APP_HOST+"/live/vote.php",access_token:window.access_token,ajax:n.ajax,postVote:function(e,t){var i=this,r={vid:e.vid,options:e.options,access_token:i.access_token};$.ajax({type:"GET",url:i.voteUrl,data:"access_token="+r.access_token+"&action=vote&vid="+r.vid+"&option="+r.options,dataType:"jsonp",success:function(e){n.callback(t,e)}})},getVoteDetail:function(e,t){var i=this;$.ajax({type:"GET",data:"access_token="+i.access_token+"&action=getVoteList&vid="+e,url:i.voteUrl,dataType:"jsonp",success:function(e){n.callback(t,e)}})}};return i}),define("plugins/flower/flower",["require","../../utils/map","../../core/mt.static","../../core/room.init","../../utils/tools"],function(e){var t=e("../../utils/map"),n=e("../../core/mt.static"),i=e("../../core/room.init"),r=e("../../utils/tools"),o={flowerUrl:n.APP_HOST+"/live/flower.php",access_token:i.getAccessToken(),ajax:r.ajax,defaults:{amount:0,duration:0,passTime:0,leftTime:0},flowerDuration:0,flowerTimer:null,flowerCountdwon:function(e,n){var i=this,n=n||"",o=e.data;if(clearTimeout(i.flowerTimer),i.defaults.amount="get"===n?o.amount||0:"send"===n?o.left_amount||0:o.amount,i.defaults.duration=o.time_interval,i.defaults.passTime=o.pass_time,i.defaults.leftTime=o.left_time,i.defaults.amount>=3)return!1;var a=i.defaults.passTime;r.debug("鲜花统计时间过去====> "+a);var s=function(){a>=0&&(i.flowerTimer=setTimeout(function(){var e=parseInt(a/i.defaults.duration,10);if(e>0&&3>=e)i.defaults.amount=e,t.get("flower:total")(e);else if(e>3)return clearTimeout(i.flowerTimer),!1;a+=1,i.defaults.passTime=a,s()},1e3))};s()},flowerStop:function(){var e=this;e.defaults.amount=0,e.defaults.duration=0,e.defaults.passTime=0,e.defaults.leftTime=0,clearTimeout(e.flowerTimer)},getFlower:function(){r.debug("Plugins: flower init...");var e=this;$.ajax({type:"GET",url:e.flowerUrl+"?act=myflower&access_token="+i.getAccessToken(),dataType:"jsonp",data:"",success:function(i){if(i.code===n.CODE_SUCCESS){e.flowerDuration=i.data.time_interval,e.flowerCountdwon(i,"get");var r={code:i.code,amount:i.data.amount};t.get("flower:get:init")(r)}else if(1202===i.code){var r={code:i.code,msg:i.msg};e.flowerStop(),t.get("flower:get:init")(r)}else if(15e3===i.code){var r={code:i.code,leftTime:i.data.left_time};t.get("flower:time:left")(r),e.flowerCountdwon(i)}}})},sendFlower:function(){var e=this;if(0===e.defaults.amount){var r=e.defaults.duration-e.defaults.passTime;return data={code:15e3,leftTime:r},t.get("flower:time:left")(data),!1}$.ajax({type:"GET",url:e.flowerUrl+"?act=send&access_token="+i.getAccessToken(),dataType:"jsonp",success:function(i){if(i.code===n.CODE_SUCCESS){e.flowerDuration=i.data.time_interval,e.flowerCountdwon(i,"send");var r={code:i.code,amount:0};t.get("flower:get:init")(r)}else if(1202===i.code){var r={code:i.code,msg:i.msg};e.flowerStop(),t.get("flower:get:init")(r)}else if(15e3===i.code){var r={code:i.code,leftTime:i.data.left_time};e.flowerDuration=i.data.time_interval,t.get("flower:time:left")(r),e.flowerCountdwon(i)}}})}};return o}),define("plugins/plugin.control",["require","./vote/vote","./flower/flower"],function(e){var t=e("./vote/vote"),n=e("./flower/flower"),i={vote:t,flower:n,lottery:function(){}};return i}),define("pako",["require"],function(){var e=window.pako;return"undefined"==typeof e?(alert("Pako压缩包未引入"),!1):e}),define("fabric",["require","utils/tools"],function(e){var t=e("utils/tools");if(t.isMobile()){var n=window.fabric;return"undefined"==typeof n?(alert("请加载 fabric 库"),!1):n}}),define("core/static",[],function(){var e={player:{},camera:{},CODE:{}};return e.CODE.SUCCESS=0,e.CODE.MEMBER_FORBIDDEN=10034,e.CODE_SUCCESS=0,e.EC_SUCCESS=0,e.EC_GENERAL_ERROR=-1,e.APP_HOST="http://open.rye-tech.com",e.MT_ADDMAPLIST_ERROR="绑定监听事件错误",e.SOCKET_CONNECT_NOTE="初始化未完成,请稍后重试",e.MT_CONNECTING="connecting",e.MT_CONNECT_SUCCESS="connect",e.MT_CONNECT_FAILED="connect_failed",e.MT_CONNECT_ERROR="error",e.MT_DISCONNECT="disconnect",e.MT_RECONNECTING="reconnecting",e.MT_RECONNECTING_FAILED="reconnecting_failed",e.PLAYER_CMD_START=1,e.PLAYER_CMD_PAUSE=2,e.PLAYER_CMD_STOP=3,e.PLAYER_CMD_RESUME=4,e.player.bufferlength=.5,e.player.bufferTimeMax=1,e.player.bufferTimeArr="[0.8,1.5,3]",e.player.cmdTimeDelay=0,e.camera.bufferlength=.5,e.camera.bufferTimeMax=1,e.camera.bufferTimeArr="[0.8,1.5,3]",e.VOICE_FLOW_DEFAULT=1,e.VOICE_FLOW_ADAPTER=2,e.VOICE_MODE_FREEDOM=0,e.VOICE_MODE_CHAIRMAN=1,e.VOICE_MODE_QUEUE=2,e.VOICE_MODE_HAND=3,e}),define("utils/schedule",["require","./tools"],function(e){var t=e("./tools"),n={initDuration:0,playDuration:0,delayDuration:0,jobs:[],timmer:null,setPlayDuration:function(e){e>=0&&(this.playDuration=e,window.localStorage&&localStorage.setItem("playDuration",e))},addSchedule:function(e,t,n){var i={st:e,command:t,callback:n};this.jobs.push(i)},clearSchedule:function(){this.jobs=[]},run:function(){function e(){this.timmer=setTimeout(function(){if(i.jobs.length>0)for(var r=0;r<i.jobs.length&&(n=i.jobs[r],n.st<=i.initDuration+i.playDuration-i.delayDuration||"undefined"!=typeof n.command.receiveTime&&t.now()-n.command.receiveTime>10);r++)i.fire(i.jobs.shift());e()},200)}if(!this.timmer){var n,i=this;this.timmer||e()}},pause:function(){this.timmer&&(clearTimeout(this.timmer),this.timmer=null)},stop:function(){this.initDuration=0,this.setPlayDuration(0),this.pause(),this.clearSchedule()},fire:function(e){e.callback&&"function"==typeof e.callback&&e.callback(e.command)}};return window.schedule=n,n}),define("controllers/sdk_control",["require","../utils/schedule"],function(e){var t=e("../utils/schedule"),n={queueTimmer:null,methodQueue:[],configs:{},call:function(e,t){t||(t="{}"),"object"==typeof t&&(t=JSON.stringify(t)),this.methodQueue.push({method:e,args:t}),this.run()},run:function(){var e=this;clearInterval(e.queueTimmer),this.queueTimmer=setInterval(function(){if(e.methodQueue.length>0){var t=e.methodQueue.shift();document.location.href="htsdk://"+t.method+"#"+t.args}else clearInterval(e.queueTimmer)},100)},config:function(){var e=this;this.call("config",e.configs)},cameraStart:function(e,t){this.call("cameraStart",'{"server":"'+e+'","path":"'+t+'"}')},cameraStop:function(){this.call("cameraStop")},cameraShow:function(){this.call("cameraShow")},cameraHide:function(){this.call("cameraHide")},audioStart:function(e,t){this.call("audioStart",'{"server":"'+e+'","path":"'+t+'"}')},audioStop:function(){this.call("audioStop")},mediaStop:function(){this.call("mediaStop")},fullScreen:function(e){e?this.call("fullScreen",'{"on":"1"}'):this.call("fullScreen",'{"on":"0"}')},goback:function(){this.call("goback")},play:function(){this.call("play")},pause:function(){this.call("pause")},seek:function(e){this.call("seek",{duration:e})},onReconnect:function(){t.initDuration=t.initDuration+t.playDuration,this.setPlayDuration(0)},setPlayDuration:function(e){t.setPlayDuration(e)},verification:function(){return"f66b9b031dd8fcd"},durationTimer:null,playInit:function(){var e=this;try{e.durationTimer=setInterval(function(){var t=JSInterface.getPlayDuration();e.setPlayDuration(t)},300)}catch(t){}},stopDurationcall:function(){clearInterval(this.durationTimer)}};return window.SDK=n,n}),define("core/h5.player",["require","jquery","fabric","./static","../utils/tools","../utils/map","../controllers/sdk_control","./room.init","./log","../utils/schedule"],function(e){var t=e("jquery"),n=e("fabric"),r=e("./static"),o=e("../utils/tools"),a=e("../utils/map"),s=e("../controllers/sdk_control"),c=e("./room.init"),u=e("./log"),l=e("../utils/schedule"),f="start",h="stop",d=11,p=15,m=16,g=20,v=25,y=31,b=51,w=101,_=102,k=103,x=104,S=1111,T=1,C=window.document.body.clientWidth,E=.75*C,O={action:"wait",room:null,playNumber:1,room:null,stream:null,page:0,st:0,width:C,height:E,pptWidth:1280,pptHeight:960,whiteBoardWidth:800,whiteBoardHeight:600,ratio:4/3,rwidth:800,rheight:600,cameraWidth:280,cameraHeight:210,mainContainerId:null,mainPlayerId:null,cameraContainerId:null,cameraPlayerId:"camera-player",pages:{},commands:{},canvasObj:{},imageObj:{},textObj:{},strokeObj:{},circleObj:{},ctx:{},durationTimmer:null,initPlayer:function(e){o.debug("=====H5 ROOM=======",e),this.room=e;var t=e.InitData;return o.debug("=====h5 player init=======",t),l.delayDuration=o.isMobileSDK()?1:4,l.run(),"wait"===t.action?void this.wait():(t.step1&&this.execute(t.step1),t.step2&&this.execute(t.step2),t.step3&&this.execute(t.step3),t.step4&&this.execute(t.step4),void("start"===this.action&&(l.initDuration=e.live.duration)))},config:function(e){"object"==typeof e&&(e.width&&(this.cameraWidth=parseInt(e.width)),e.height&&(this.cameraHeight=parseInt(e.height)),e.playType&&(this.playType=e.playType))},getRatio:function(e,t){var n,i,r=this,o=r.ratio,a=e||window.document.body.clientWidth,s=t||window.document.body.scrollHeight;return a/s>o?(n=s*o,i=s):(n=a,i=a/o),{width:n,height:i}},getSDK:function(){return s},mainPlayer:function(e,t,n){this.mainContainerId=e,this.playerCallback=n,o.debug(e,this.mainContainerId),"function"==typeof n&&n(this.getRatio())},camera:function(e,t,n){this.cameraContainerId=e,this.cameraPlayerId=t,this.cameraCallback=n,o.isMobileSDK()},cameraShow:function(){},cameraHide:function(){},getCamera:function(){var e=document.getElementById(this.cameraPlayerId);if(!e){var e;o.isWechat()?e=document.createElement("video"):o.isIphone()?(e=document.createElement("audio"),e.setAttribute("controls","controls"),e.className="camera_iphone"):o.userAgent("ipad")?(e=document.createElement("video"),e.setAttribute("controls","controls")):o.isAndroid()?(e=document.createElement("video"),e.setAttribute("controls","controls")):(e=document.createElement("video"),e.setAttribute("controls","controls")),e.id=this.cameraPlayerId,e.autoplay=!0,e.setAttribute("webkit-playsinline","webkit-playsinline"),e.setAttribute("autoplay","autoplay");var t=window.document.body;t.appendChild(e),"function"==typeof this.cameraCallback&&this.cameraCallback(e)}return e},canvasId:function(e){return"canvas-"+e},canvas:function(e){var t=this.canvasId(e);if(!this.canvasObj[t]){var n=document.getElementById(t);if(!n){o.debug("load canvas from "+this.mainContainerId);var i=this.getRatio(),n=document.createElement("canvas");n.style.width=i.width+"px",n.style.height=i.height+"px",n.width=i.width,n.height=i.height,n.className="canvas-player",n.id=t;var r=document.getElementById(this.mainContainerId);r.style.width=this.width,r.style.height=this.height,r.style.background="#ffffff",r.style.backgroundColor="#ffffff",n.style.zIndex="draw"===e?"2":"1",n.style.position="absolute",r.appendChild(n)}this.canvasObj[t]=n}return this.canvasObj[t]},context:function(e){var t=this.canvasId(e),i=this;if(!this.ctx[t]){var r=i.getRatio(),o=this.canvas(e),a=new n.Canvas(t,{selection:!1});a.selection=!1,a.setDimensions({width:r.width,height:r.height}),a.calcOffset(),this.ctx[t]=a,o.parentNode.style.position="absolute"}return this.ctx[t]},startDurationTimmer:function(){var e=this;if(!e.durationTimmer)if(o.isMobileSDK())e.durationTimmer=setInterval(function(){a.get("live:duration")(l.playDuration,e.duration,l.playDuration/e.duration)},500);else{var t=this.getCamera();e.durationTimmer=setInterval(function(){t.currentTime&&(e.currentTime=t.currentTime,l.setPlayDuration(t.currentTime),a.get("live:duration")(t.currentTime,e.duration,t.currentTime/e.duration))},200)}},play:function(){o.debug("========play==========");o.isMobileSDK()||(this.getCamera().play(),t.ajax({type:"GET",url:r.APP_HOST+"/live/info.php",dataType:"jsonp",data:"access_token="+c.getAccessToken(),success:function(e){e.code===r.CODE.SUCCESS&&(l.initDuration=e.data.duration,l.playDuration=0)}})),this.startDurationTimmer()},pause:function(){o.debug("========pause=========="),o.isMobileSDK()?s.mediaStop():this.getCamera().pause()},stop:function(){},whiteBoard:function(e){var t=e.args,n=this;if(t.metadata)try{var i=JSON.parse(t.metadata);if(i.st<this.st)return;if(this.st=i.st,i.t==d||i.t==p||i.t==m||i.t==g||i.t==v||i.t==b)return i.receiveTime=o.now(),l.addSchedule(i.st,i,function(e){o.debug("schedule:",e),n.dispatch(e,!0)});this.dispatch(i,!0)}catch(r){}},dispatch:function(e,t){try{if("string"==typeof e&&(e=JSON.parse(e)),e.t==y)for(var n,i=0;i<e.d.length;i++)n=JSON.parse(e.d[i]),t&&this.pushCommands(e),this.execute(n);else t&&this.pushCommands(e),this.execute(e)}catch(r){}},initStorage:function(){this.st=0,this.pages={},this.commands={},this.imageObj={},this.textObj={}},pushCommands:function(e){if(o.in_array(e.t,[d,p,m,g,v]))this.commands[e.p]||(this.commands[e.p]=[]),this.commands[e.p].push(e);else if(e.t==b){var t=e.c.split("|")[0];if(!this.isWhiteBoard(e.p)){var n=this.getPage(e.p);if(n){var i=n.c.split("|");t!=i[0]&&this.flushCommands(e.p)}}this.pages[e.p]=e}},flushCommands:function(e){this.commands[e]&&delete this.commands[e]},getCommands:function(e,n){if(o.debug("get commands."),this.commands[e]&&0!==this.commands[e].length)n(this.commands[e]);else{var i=this,a=r.APP_HOST+"/live/command.php";t.ajax({type:"GET",url:a,dataType:"jsonp",data:"access_token="+c.getAccessToken()+"&page="+e,success:function(t){t.code===r.CODE.SUCCESS&&(o.debug("get commands from server:",t.data),i.commands[e]=t.data,n(t.data))}})}},getPage:function(e){return this.pages[e]},execute:function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){return o.debug("h5 player execute command error:"+t)}o.debug("h5 player execute:",e);var n,i=this;e.t==f?this.start(e):e.t==b?this.setPage(e):e.t==v?this.stroke(e):e.t==d?this.image(e):e.t==m?this.circle(e):e.t==p?this.text(e):e.t==k||e.t==x?this.video(e):e.t==w||e.t==_?this.cameraDo(e):e.t==S?this.imagePreload(e):e.t==h&&this.stop(e),i.pageContent=n},start:function(e){o.debug("h5 live start");var t=this,n=this.room.user;if(t.action=e.t,t.initStorage(),s.configs={videoWidth:t.width,videoHeight:t.height,cameraWidth:150,cameraHeight:112.5,cameraLeft:t.width-100,cameraTop:t.height,action:t.action,xid:n.xid,uid:n.uid,rid:n.roomid,pid:n.pid},o.isMobileSDK())s.config(),s.mediaStop();else{var i=this.getCamera();i.pause(),this.statsPlay()}this.action="start",a.get("live:start")()},statsPlay:function(){var e=this,t=this.room.user;u.play({xid:t.xid,uid:t.uid,pid:t.partner_id,rid:t.roomid,pf:"html5",pt:1,pl:"start"===e.action?1:0,cbt:0,bn:0,ba:0,pn:e.playNumber});setTimeout(function(){e.statsPlay(),++e.playNumber},6e4)},stop:function(e){if(this.action=e.t,this.clear(),this.initStorage(),o.isMobileSDK())s.mediaStop();else{var t=this.getCamera();t.pause()}this.action="stop",a.get("live:stop")()},wait:function(){this.action="wait",this.action===f?a.get("live:stop")():a.get("live:wait")()},isDraw:function(e,t){for(var n=!1,i=e.getObjects(),r=0;r<i.length;r++)i[r].id===t&&(n=!0);return n},setPage:function(e){this.page=e.p,this.pages[e.p]=e;var t=e.p,i=this,r=e.c.split("|"),a=this.context("ppt"),s=this.context("draw");if(this.isWhiteBoard(t))o.debug("load canvas whiteBoard..."),a.clear(),s.clear(),a.backgroundColor=this.getColor(r[4]),line=new n.Line([0,0,0,0]),a.add(line),this.getCommands(e.p,function(e){if(e.length>0)for(var t=0;t<e.length;t++)i.dispatch(e[t])});else{var c=i.scaleX(a,e.p),u=i.scaleY(a,e.p),l=r[0],f=l+r[1]+"_"+r[5]+".jpg";o.debug("ppt url:"+f),a.setBackgroundColor(""),this.loadImage(f,function(t){if(i.page!=e.p)return!1;a.clear(),s.clear();var n=document.getElementById("ppt-image");n||(n=document.createElement("img"),n.id="ppt-image",n.style.zIndex="0",document.getElementById(i.mainContainerId).appendChild(n)),n.style.paddingLeft=(a.width-t.width*c)/2+"px",n.style.paddingTop=(a.height-t.height*u)/2+"px",n.style.paddingBottom=n.style.paddingTop,n.width=t.width*c,n.height=t.height*u,n.src=t.src,i.getCommands(e.p,function(e){if(e.length>0)for(var t=0;t<e.length;t++)i.dispatch(e[t])})})}},image:function(e){function t(e){setTimeout(function(){i.imageObj[o]!==o?(i.imageObj[o].width=i.imageObj[o].originWidth*l*h,i.imageObj[o].height=i.imageObj[o].originHeight*f*d,i.imageObj[o].visible=s,i.imageObj[o].transformMatrix=p,i.isDraw(u,o)||u.add(i.imageObj[o]),s?(u.bringToFront(i.imageObj[o]),u.renderAll()):(u.remove(i.imageObj[o]),delete i.imageObj[o])):t(e)},1e3*e)}var i=this,r=e.c.split("|"),o=r[0],a=r[1],s=parseInt(r[2])===T?!0:!1,c=(r[3],r[4].split(",")),u=(parseFloat(c[4]),parseFloat(c[5]),this.context("ppt")),l=this.scaleX(u,e.p),f=this.scaleY(u,e.p),h=parseFloat(c[0]),d=parseFloat(c[3]),p=[parseFloat(1),parseFloat(c[1]),parseFloat(c[2]),parseFloat(1),parseFloat(c[4])*l,parseFloat(c[5])*f];if(i.imageObj[o]){var m=0;i.imageObj[o]===o&&(m=1),t(m)}else i.imageObj[o]=o,n.Image.fromURL(a,function(e){e.id=o,e.originWidth=e.width,e.originHeight=e.height,e.width=e.width*l*h,e.height=e.height*f*d,e.selectable=!1,e.visible=s,e.transformMatrix=p,e.backgroundColor="red",i.imageObj[o]=e,u.add(e),e.setCoords()})},loadImage:function(e,t){var n=this;if(n.imageObj[e])return t(n.imageObj[e]);var i=new Image;i.src=e,i.onload=function(){n.imageObj[e]=i,t(i)}},m3u8:function(e){return e=e.replace("rtmp://","http://"),e=e.replace("live-pull","hls"),e=e.split("|"),e[0]+"/"+e[1]+"/playlist.m3u8"},video:function(e){if(e.t==k)if(o.isMobileSDK()){var t=e.c.split("|");o.debug("SDK audio start:",t),this.stream=t,s.audioStart(t[0],t[1])}else{var n=this.m3u8(e.c);o.debug("play m3u8:"+n);var i=this.getCamera();i.autoplay="autoplay",i.src=n,i.play(),this.play()}else e.t==x&&this.pause()},cameraDo:function(e){var t=this;if(e.t==w){if(o.isMobileSDK())this.stream&&s.cameraStart(t.stream[0],t.stream[1]);else{var n=this.getCamera();n.width=this.cameraWidth,n.height=this.cameraHeight}a.get("camera:start")()}else if(e.t==_){if(o.isMobileSDK())s.cameraStop();else{var n=this.getCamera();n.width=0,n.height=0}a.get("camera:stop")()}},imagePreload:function(e){var t=e.c.split("|"),n=t[0]+t[1]+"_"+t[5]+".jpg";this.loadImage(n,function(){o.debug("image preload success:"+n)})},circle:function(e){var t,i,r,o,a=this.context("draw"),s=e.c.split("|"),c=s[0],u=s[1]==T?!0:!1,l=parseFloat(s[2]),f=parseFloat(s[3]),h=parseFloat(s[4]),d=parseFloat(s[5]);h>l?(t=f,i=l,r=(h-l)/2,o=(d-f)/2):(t=f,i=h,r=(l-h)/2,o=(d-f)/2);var p=this.scaleX(a,e.p),m=this.scaleY(a,e.p);if(this.circleObj[c]&&this.isDraw(a,c))this.circleObj[c].visible=u,a.renderAll();else{var g=new n.Ellipse({id:c,top:t*p,left:i*m,rx:r,ry:o,fill:"",stroke:this.getColor(s[7]),strokeWidth:parseInt(s[6]),scaleX:p,scaleY:m,selectable:!1});a.add(g),this.circleObj[c]=g}},text:function(e){var t=this.context("draw"),i=this.scaleX(t,e.p),r=this.scaleY(t,e.p),o=e.c.split("|"),a=o[0],s=unescape(o[1]),c=this.getColor(o[2]),u=parseInt(o[3])*i,l=parseInt(o[4])===T?!0:!1,f=o[6].split(","),h=(parseFloat(f[4]),parseFloat(f[5]),[parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),parseFloat(f[4])*i,parseFloat(f[5])*r]);if(this.textObj[a]&&this.isDraw(t,a))this.textObj[a].setText(s),this.textObj[a].visible=l,this.textObj[a].transformMatrix=h,t.renderAll();else{var d=new n.Text(s,{id:a,fill:c,fontSize:u,visible:l,fontWeight:"normal",transformMatrix:h,backgroundColor:"",textBackgroundColor:"",selectable:!1});d.transformMatrix=h,d.setText(s),this.textObj[a]=d,t.add(d)}},isWhiteBoard:function(e){return e>1e4?!0:!1},scaleX:function(e,t){return this.isWhiteBoard(t)?e.width/this.whiteBoardWidth:e.width/this.pptWidth},scaleY:function(e,t){return this.isWhiteBoard(t)?e.height/this.whiteBoardHeight:e.height/this.pptHeight},stroke:function(e){var t=this.context("draw"),i=this.drawSerialize(t,e),r=i.objectId,o=i.graph.data,a={},s="";if(o.length>0)if(this.strokeObj[r]&&this.isDraw(t,r))t.renderAll();else{for(var c=0;c<o.length;c++)a=o[c],"M"===a.name?s+=" M "+a.x+" "+a.y:"L"===a.name?s+=" L "+a.x+" "+a.y:"C"===a.name&&(s+=" Q "+a.x+","+a.y+","+a.archX+","+a.archY);var u=new n.Path(s,{id:r,fill:"",stroke:i.color,strokeWidth:i.thickness,selectable:!1});this.strokeObj[r]=u,t.add(u)}},drawSerialize:function(e,t){var n=this.scaleX(e,t.p),i=this.scaleY(e,t.p),r=t.c,o={},a=r.split("|"),s=a[0],c=this.getColor(a[1]),u=a[2]*n,l=a[3]==T?!0:!1,f=a[4],h=f.split(","),d={lineStyle:{thickness:u,color:c},moveTo:{},data:[]},p=0;"M"===h[0]&&(d.moveTo={x:h[1]*n,y:h[2]*i},p=3);for(var m={};p<h.length;)switch(h[p]){case"M":m={name:h[p],x:parseInt(h[p+1])*n,y:parseInt(h[p+2])*i},d.data.push(m),p+=3;break;case"L":m={name:h[p],x:parseInt(h[p+1])*n,y:parseInt(h[p+2])*i},d.data.push(m),p+=3;break;case"C":m={name:h[p],x:parseInt(h[p+1])*n,y:parseInt(h[p+2])*i,archX:parseInt(h[p+3])*n,archY:parseInt(h[p+4])*i},d.data.push(m),p+=5}return o={objectId:s,color:c,thickness:u,visible:l,graph:d}},getColor:function(e){if(e=parseInt(e),e=e.toString(16),e.length<6){var t=6-e.length;for(i=0;t>i;i++)e="0"+e}return e="#"+e},clear:function(){this.context("ppt").clear(),this.context("draw").clear()},draw:function(){var e=this.getPage(this.page);e&&this.execute(e)},resize:function(e,t){var n=this.getRatio(e,t);e=n.width,t=n.height;var i=document.getElementById("ppt-image");i&&(i.width=e,i.height=t),this.clear(),this.width=e,this.height=t;var r=this.context("ppt"),o=this.context("draw");return r.setDimensions({width:e,height:t}),r.calcOffset(),o.setDimensions({width:e,height:t}),o.calcOffset(),this.draw(),{width:e,height:t}}};return window.player=O,O}),define("sdk.core",["require","./core/socket.init","./core/socket.maplist","./core/room.init","./core/mt.static","./utils/tools","./utils/map","./core/question","./core/member","./voice/voice.control","./plugins/plugin.control","pako","./core/h5.player","./core/player"],function(e){var t=e("./core/socket.init"),n=(e("./core/socket.maplist"),e("./core/room.init")),i=e("./core/mt.static"),r=e("./utils/tools"),o=e("./utils/map"),a=e("./core/question"),s=e("./core/member"),c=e("./voice/voice.control"),u=e("./plugins/plugin.control"),l=e("pako"),f={};r.debug("platform:"+r.platform()),f=e(r.isMobile()?"./core/h5.player":"./core/player");var h={room:{},tools:r,socket_connect_success:!1,room_init:!1,me:{},zhubo:{},action:"wait"};return h.main=function(e,t){h.room.access_token=e,this.init(e,t)},h.main.prototype.init=function(e,t){var i=this;n.init(e,function(e){i.room(e,t),i.serverRoom=e})},h.main.prototype.room=function(e){var n=e,i=this,o=h.room;o.initData=n.InitData,o.appHost=n.appHost,o.conString=n.conString,o.heartbeatInterval=n.heartbeatInterval,o.live=n.live,o.modules=n.modules,o.plugin=n.plugin,o.rtmp=n.rtmp,o.curUser=n.user,o.voiceFlow=n.voiceFlow,o.zhubo=n.zhubo,o.user=n.user,o.title=n.InitData.title,o.websocket=n.websocket,o.cameraUrl=n.cameraUrl,o.swfUrl=n.swfUrl,o.livingDuration=n.live.duration,o.announce=n.announce,o.flashvar=n.flashvar,h.room=o,t.init(h.room,function(e){r.debug("===> room: ",h.room),i._applyByInit(h.room),i._listen(e)})},h.main.prototype.getLiveState=function(){var e=f.action;return e},h.main.prototype.packetHandler=function(e){switch(e.cmd){case"video:whiteboard":f.whiteBoard(e);break;case"video:player":try{f.controlPlayer(e)}catch(t){}o.get("video:player")(e.args.action);break;case"member:leave":s.deleteMember(e.args);break;case"member:join:other":s.addMember(e.args);break;case"voice:mode:change":c.VoiceModel(e.args.mode,{},e.args);break;case"voice:power:forbid":c.VoiceForbid(e.args.data.xid,e.args.data.voice);break;case"voice:power:allow":c.VoiceAllow(e.args.data.xid,e.args.data.voice);break;case"voice:hand:up":case"voice:hand:leave":case"voice:hand:allow":case"voice:hand:forbid":case"voice:hand:remove":case"voice:hand:clear":c.VoiceModelAppoint(e.cmd,e);break;case"voice:queue:list":case"voice:queue:join":case"voice:queue:leave":case"voice:queue:move":case"voice:queue:clear":case"voice:queue:control":case"voice:queue:moveto":case"voice:queue:time":c.VoiceModelAppoint(e.cmd,e)}return e.args},h.main.prototype._applyByInit=function(e){var n=this;n.export2Window(),f.room=e,o.get("mainPlayer")(),o.get("camera")(),n.voice(e,t),h.me=e.curUser},h.main.prototype.export2Window=function(){var e=h.room,t=this;window.MT={},window.MT.CODE=i.CODE,window.MT.STATIC_HOST=i.STATIC_HOST,window.MT.me=e.curUser,window.MT.zhubo=e.zhubo,window.MT.title=e.title,window.MT.tools=h.tools,window.MT.getLiveState=t.getLiveState,window.MT.liveDuration=e.livingDuration||-1,window.MT.announce=e.announce,window.MT.live=t.flash(e),window.__map=o},h.main.prototype.flash=function(e){var t={playerLoaded:function(){r.debug("MT.live.mainPlayerLoaded"),f.playerLoaded=!0;e.initData;return f.getPlayer(function(e){f.mainPlayerCallback(o.get("mainPlayerCallback")(e))}),this.syncLoad("mainPlayer LoadSuccess..."),!0},cameraPlayerLoaded:function(){r.debug("MT.live.cameraPlayerLoaded");return f.cameraPlayerLoaded=!0,f.getCameraPlayer(function(e){f.cameraCallback(e)}),this.syncLoad("cameraPlayer LoadSuccess..."),!0},syncLoad:function(t){r.debug("syncLoad() ===> "+t),f.playerLoaded===!0&&f.cameraPlayerLoaded===!0&&f.initPlayer(e)},getVoiceMode:function(){return f.getVoiceMode()},cameraPlay:function(e,t){r.debug("camera call play:"+f.cameraPlayerId),null!==f.cameraPlayerId&&r.getFlash(f.cameraPlayerId).cameraPlay(e,t)},cameraShow:function(){r.debug("camera call show."),null!==f.cameraPlayerId&&o.get("camera:start")()},cameraHide:function(){r.debug("camera call hide."),null!==f.cameraPlayerId&&o.get("camera:stop")()},cameraStop:function(){r.debug("camera call stop."),null!==f.cameraPlayerId&&f.getCameraPlayer(function(e){e.cameraStop()})},cameraSetVolume:function(e){r.getFlash(f.cameraPlayerId).cameraSetVolume(e)},swfRemote:function(e){r.getFlash(f.cameraPlayerId).swfRemote(e)},cameraCommand:function(e){r.getFlash(f.cameraPlayerId).cameraCommand(e)},optCommand:function(e){f.getPlayer(function(t){t.optCommand(e)})}};return t},h.main.prototype._listen=function(e){var n=this,i={};e.on("_bro:zip",function(e){r.debug("socket on : _broadcast:zip");try{e=l.inflate(e,{to:"string"}),e=JSON.parse(e)}catch(a){r.debug("_bor:zip ERROR====> "+a.message)}r.debug("package=====> "+e);var s=function(){if("undefined"!=typeof i){var e=o.get(i.cmd);try{var t=n.packetHandler(i);t&&e(t)}catch(r){throw new Error("方法未定义:"+r.message)}}};if("undefined"!=typeof e.cmd)i=t.onBroadcast(e),s();else if(e.length)for(var c=0,u=e.length;u>c;c++)i=t.onBroadcast(e[c]),s();var f=null;if(h.room_init===!1){var d=o.get("room:init");f=setInterval(function(){document.readyState&&"complete"===document.readyState?(d(document.readyState),h.room_init=!0,clearInterval(f)):(d(),clearInterval(f))},300)}})},h.main.prototype.emit=function(){var e=arguments.length,n=arguments;if(t.connectSuc)if(this.emitTrigger(n),2===e){if("string"==typeof n[0]&&"function"==typeof n[1]){var r=n[0],o=n[1];t.emit(r,o)}}else{if(3!==e)return n;if("string"==typeof n[0]&&"undefined"!=typeof n[1]&&"function"==typeof n[2]){var r=n[0],a=n[1],o=n[2];t.emit(r,a,function(e){e.code===i.CODE.SUCCESS&&o(e)})}}else alert(i.SOCKET_CONNECT_NOTE+": "+r)},h.main.prototype.emitTrigger=function(e){var t=e[0],n=e[1],i=e[2];switch(t){case"question:ask":var r={action:"question",type:"question",typeId:"ask",replyId:n.replyId,content:n.msg};a.quesPost("ask",r,i);break;case"question:reply":var r={action:"answer",type:"answer",typeId:"reply",replyId:n.replyId,content:n.msg};a.quesPost("reply",r,i);break;case"question:get:list":a.getList(h.room.access_token,i)}},h.main.prototype.on=function(e,t){"undefined"!=typeof e&&e.length>0&&"string"==typeof e&&"undefined"!=typeof t&&"function"==typeof t?o.put(e,t):alert(i.MT_ADDMAPLIST_ERROR+": "+e)},h.main.prototype.get=function(e,t){"undefined"!=typeof e&&e.length>0&&"string"==typeof e?o.get(e)(t):alert(i.MT_ADDMAPLIST_ERROR+": "+e)},h.main.prototype.mainPlayer=function(e,t,n){var i=this;this.on("mainPlayerCallback",n),this.on("mainPlayer",function(){f.mainPlayer(e,t,n),r.isMobile()&&setTimeout(function(){f.initPlayer(i.serverRoom)},500)})},h.main.prototype.camera=function(e,t,n){this.on("cameraCallback",n),this.on("camera",function(){f.camera(e,t,n)})},h.main.prototype.member=function(e){return t.connectSuc?void e(s.userList):!1},h.main.prototype.voice=function(e,t){c.init(e,t,this)},h.main.prototype.getQuestion=function(e){a.getList(h.room.access_token,e)},h.main.prototype.plugins=function(e){switch(e){case"vote":return u.vote;case"flower":return u.flower;case"lottery":break;case"score":}return u},h.main.prototype.play=function(){f.play()},h.main.prototype.pause=function(){f.pause()},h}),define("sdk.exports",["sdk.core"],function(e){return e}),{SDK:require("sdk.exports")}});